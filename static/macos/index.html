<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>macOS</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }

    :root {
      --menu-bg: rgba(36, 33, 40, 0.75);
      --dock-bg: rgba(50, 48, 55, 0.45);
      --text-primary: rgba(255, 255, 255, 0.95);
      --window-bg: rgba(30, 30, 35, 0.92);
      --titlebar-bg: rgba(50, 48, 54, 0.98);
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Text', 'Helvetica Neue', sans-serif;
      overflow: hidden;
      height: 100vh;
      width: 100vw;
      user-select: none;
      cursor: default;
    }

    .wallpaper {
      position: fixed;
      inset: 0;
      background: #1a1a2e;
    }

    /* Menu Bar */
    .menu-bar {
      position: relative;
      height: 25px;
      background: var(--menu-bg);
      backdrop-filter: blur(30px) saturate(180%);
      -webkit-backdrop-filter: blur(30px) saturate(180%);
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0 8px;
      color: var(--text-primary);
      font-size: 13px;
      font-weight: 500;
      z-index: 100;
    }

    .menu-left {
      display: flex;
      align-items: center;
      gap: 1px;
    }

    .apple-logo {
      width: 32px;
      height: 25px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      border-radius: 4px;
    }

    .apple-logo:hover { background: rgba(255, 255, 255, 0.1); }

    .apple-logo svg {
      width: 13px;
      height: 16px;
      fill: var(--text-primary);
    }

    .menu-item {
      padding: 3px 10px;
      border-radius: 4px;
      cursor: pointer;
      font-size: 13.5px;
    }

    .menu-item:hover { background: rgba(255, 255, 255, 0.1); }
    .menu-item.active { font-weight: 600; }

    .menu-right {
      display: flex;
      align-items: center;
      gap: 2px;
    }

    .menu-icon {
      padding: 3px 6px;
      border-radius: 4px;
      cursor: pointer;
      display: flex;
      align-items: center;
      font-size: 13px;
    }

    .menu-icon:hover { background: rgba(255, 255, 255, 0.1); }
    .menu-icon svg { width: 16px; height: 16px; fill: var(--text-primary); }

    .menu-time {
      font-weight: 500;
      padding: 3px 8px;
      font-variant-numeric: tabular-nums;
    }

    .battery {
      display: flex;
      align-items: center;
      gap: 4px;
      font-size: 12px;
    }

    .battery-icon { display: flex; align-items: center; }

    .battery-body {
      width: 22px;
      height: 11px;
      border: 1.5px solid var(--text-primary);
      border-radius: 3px;
      padding: 1.5px;
      display: flex;
    }

    .battery-level {
      width: 75%;
      background: #32d74b;
      border-radius: 1px;
    }

    .battery-cap {
      width: 2px;
      height: 5px;
      background: var(--text-primary);
      border-radius: 0 1px 1px 0;
      margin-left: 1px;
    }

    /* Desktop */
    .desktop {
      position: fixed;
      top: 25px;
      left: 0;
      right: 0;
      bottom: 0;
      padding: 12px;
      display: flex;
      justify-content: flex-end;
    }

    .desktop-icons-container {
      display: flex;
      flex-direction: row-reverse;
      gap: 4px;
      align-items: flex-start;
    }

    .desktop-column {
      display: flex;
      flex-direction: column;
      gap: 2px;
      align-items: flex-end;
    }

    .desktop-icon {
      display: flex;
      flex-direction: column;
      align-items: center;
      width: 85px;
      padding: 6px;
      border-radius: 6px;
      cursor: pointer;
      transition: background 0.15s;
    }

    .desktop-icon:hover { background: rgba(255, 255, 255, 0.12); }
    .desktop-icon.selected { background: rgba(0, 122, 255, 0.4); }

    .icon-wrapper {
      width: 60px;
      height: 60px;
      margin-bottom: 5px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .desktop-icon-img {
      width: 60px;
      height: 60px;
      object-fit: contain;
    }

    .icon-label {
      color: white;
      font-size: 11px;
      font-weight: 500;
      text-align: center;
      text-shadow: 0 1px 3px rgba(0, 0, 0, 0.6), 0 0 8px rgba(0, 0, 0, 0.3);
      line-height: 1.25;
    }

    /* Dock */
    .dock-wrapper {
      position: fixed;
      bottom: 5px;
      left: 50%;
      transform: translateX(-50%);
      z-index: 50;
      padding: 3px;
    }

    .dock {
      display: flex;
      align-items: flex-end;
      gap: 5px;
      padding: 4px 8px;
      background: var(--dock-bg);
      backdrop-filter: blur(30px) saturate(170%);
      -webkit-backdrop-filter: blur(30px) saturate(170%);
      border-radius: 18px;
      border: 0.5px solid rgba(255, 255, 255, 0.2);
      box-shadow: 0 0 0 0.5px rgba(0,0,0,0.3), 0 10px 40px rgba(0, 0, 0, 0.35);
    }

    .dock-item-container {
      position: relative;
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    .dock-item {
      width: 50px;
      height: 50px;
      border-radius: 11px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: transform 0.2s cubic-bezier(0.34, 1.56, 0.64, 1), margin 0.2s;
      background: transparent !important;
      box-shadow: none !important;
    }

    .dock-item:hover {
      transform: translateY(-10px) scale(1.15);
      margin: 0 6px;
    }

    .dock-item img {
      width: 50px;
      height: 50px;
      border-radius: 11px;
      object-fit: contain;
    }

    .dock-indicator {
      width: 4px;
      height: 4px;
      background: rgba(255, 255, 255, 0.9);
      border-radius: 50%;
      margin-top: 3px;
      box-shadow: 0 0 4px rgba(255, 255, 255, 0.4);
      display: none;
    }

    .dock-indicator.active { display: block; }

    .dock-separator {
      width: 1px;
      height: 40px;
      background: rgba(255, 255, 255, 0.2);
      margin: 0 4px;
      align-self: center;
    }

    .dock-tooltip {
      position: absolute;
      bottom: 65px;
      left: 50%;
      transform: translateX(-50%);
      background: rgba(40, 40, 45, 0.95);
      backdrop-filter: blur(20px);
      color: white;
      padding: 5px 12px;
      border-radius: 5px;
      font-size: 12px;
      font-weight: 500;
      white-space: nowrap;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.15s;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
    }

    .dock-item-container:hover .dock-tooltip { opacity: 1; }

    /* Windows */
    .window {
      position: absolute;
      background: var(--window-bg);
      backdrop-filter: blur(40px) saturate(180%);
      -webkit-backdrop-filter: blur(40px) saturate(180%);
      border-radius: 10px;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4), 0 0 0 0.5px rgba(255,255,255,0.1);
      overflow: hidden;
      display: none;
      z-index: 10;
      display: none;
      flex-direction: column;
    }

    .window.active {
      display: flex;
    }

    .window.active {
      display: flex;
      transition: transform 0.3s ease, opacity 0.3s ease;
    }

    .window.active.minimized {
      transform: scale(0.1) translateY(500px);
      opacity: 0;
      pointer-events: none;
    }

    .window.active.fullscreen {
      top: 25px !important;
      left: 0 !important;
      width: 100% !important;
      height: calc(100vh - 95px) !important;
      max-height: calc(100vh - 95px) !important;
      border-radius: 0;
    }

    .window.focused { z-index: 20; }

    .window-titlebar {
      height: 32px;
      background: var(--titlebar-bg);
      display: flex;
      align-items: center;
      padding: 0 12px;
      gap: 8px;
      cursor: grab;
    }

    .window-titlebar:active {
      cursor: grabbing;
    }

    .window-controls {
      display: flex;
      gap: 8px;
    }

    .window-btn {
      width: 12px;
      height: 12px;
      border-radius: 50%;
      cursor: pointer;
      border: none;
      transition: filter 0.15s;
    }

    .window-btn:hover { filter: brightness(1.1); }
    .window-btn.close { background: #FF5F57; }
    .window-btn.minimize { background: #FFBD2E; }
    .window-btn.maximize { background: #28C840; }

    .window-title {
      flex: 1;
      text-align: center;
      font-size: 13px;
      font-weight: 500;
      color: rgba(255,255,255,0.85);
      margin-right: 60px;
    }

    .window-content {
      color: rgba(255,255,255,0.9);
      font-size: 13px;
      line-height: 1.5;
      overflow: auto;
      flex: 1;
      display: flex;
      flex-direction: column;
    }

    /* Terminal specific */
    .terminal-content {
      font-family: 'SF Mono', 'Monaco', 'Menlo', monospace;
      font-size: 12px;
      padding: 12px;
      background: rgba(0,0,0,0.3);
      min-height: 250px;
      flex: 1;
      overflow-y: auto;
    }

    .terminal-prompt { color: #32D74B; }
    .terminal-path { color: #5AC8FA; }

    .terminal-cursor {
      display: inline-block;
      width: 8px;
      height: 14px;
      background: rgba(255,255,255,0.7);
      animation: blink 1s step-end infinite;
      vertical-align: middle;
      margin-left: 2px;
    }

    @keyframes blink { 50% { opacity: 0; } }

    /* Chrome Browser */
    .browser-toolbar {
      height: 36px;
      background: rgba(60, 60, 65, 0.95);
      display: flex;
      align-items: center;
      padding: 0 10px;
      gap: 8px;
    }

    .browser-nav-btn {
      width: 28px;
      height: 28px;
      border-radius: 6px;
      background: transparent;
      border: none;
      color: rgba(255,255,255,0.6);
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .browser-nav-btn:hover { background: rgba(255,255,255,0.1); }

    .browser-url-bar {
      flex: 1;
      height: 28px;
      background: rgba(0,0,0,0.3);
      border-radius: 6px;
      display: flex;
      align-items: center;
      padding: 0 12px;
      color: rgba(255,255,255,0.7);
      font-size: 12px;
    }

    .browser-content {
      background: #fff;
      min-height: 300px;
      flex: 1;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #333;
    }

    /* Notes */
    .notes-container {
      display: flex;
      flex: 1;
      min-height: 300px;
    }

    .notes-sidebar {
      width: 200px;
      background: rgba(40,40,45,0.95);
      border-right: 1px solid rgba(255,255,255,0.1);
    }

    .notes-main {
      flex: 1;
      padding: 16px;
      background: rgba(30,30,35,0.95);
      overflow-y: auto;
    }

    .notes-item {
      padding: 10px 12px;
      border-bottom: 1px solid rgba(255,255,255,0.05);
      cursor: pointer;
    }

    .notes-item:hover { background: rgba(255,255,255,0.05); }
    .notes-item.active { background: rgba(0,122,255,0.3); }

    .notes-title {
      font-weight: 600;
      font-size: 13px;
      color: rgba(255,255,255,0.9);
    }

    .notes-preview {
      font-size: 11px;
      color: rgba(255,255,255,0.5);
      margin-top: 4px;
    }

    /* Messages */
    .messages-container {
      display: flex;
      flex: 1;
      min-height: 350px;
    }

    .messages-sidebar {
      width: 220px;
      background: rgba(40,40,45,0.95);
      border-right: 1px solid rgba(255,255,255,0.1);
    }

    .messages-main {
      flex: 1;
      display: flex;
      flex-direction: column;
      background: rgba(30,30,35,0.95);
      overflow: hidden;
    }

    .message-contact {
      padding: 12px;
      border-bottom: 1px solid rgba(255,255,255,0.05);
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .message-contact:hover { background: rgba(255,255,255,0.05); }

    .contact-avatar {
      width: 36px;
      height: 36px;
      border-radius: 50%;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-weight: 600;
      font-size: 14px;
    }

    .contact-info { flex: 1; }
    .contact-name { font-weight: 500; font-size: 13px; color: white; }
    .contact-preview { font-size: 11px; color: rgba(255,255,255,0.5); }

    .messages-area {
      flex: 1;
      padding: 16px;
      overflow-y: auto;
      min-height: 0;
    }

    .message-bubble {
      max-width: 70%;
      padding: 8px 12px;
      border-radius: 16px;
      margin-bottom: 8px;
      font-size: 13px;
    }

    .message-bubble.sent {
      background: #007AFF;
      color: white;
      margin-left: auto;
      border-bottom-right-radius: 4px;
    }

    .message-bubble.received {
      background: rgba(60,60,65,0.95);
      color: white;
      border-bottom-left-radius: 4px;
    }

    .message-input {
      padding: 12px;
      border-top: 1px solid rgba(255,255,255,0.1);
      display: flex;
      gap: 8px;
    }

    .message-input input {
      flex: 1;
      background: rgba(60,60,65,0.95);
      border: none;
      border-radius: 18px;
      padding: 8px 16px;
      color: white;
      font-size: 13px;
      outline: none;
    }

    /* VS Code */
    .vscode-container {
      display: flex;
      flex: 1;
      min-height: 350px;
    }

    .vscode-sidebar {
      width: 48px;
      background: rgba(30,30,35,0.98);
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 8px 0;
      gap: 8px;
    }

    .vscode-sidebar-icon {
      width: 36px;
      height: 36px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: rgba(255,255,255,0.5);
      cursor: pointer;
      border-radius: 4px;
    }

    .vscode-sidebar-icon:hover { color: white; }
    .vscode-sidebar-icon.active {
      color: white;
      border-left: 2px solid #007ACC;
    }

    .vscode-explorer {
      width: 200px;
      background: rgba(37,37,40,0.98);
      border-right: 1px solid rgba(255,255,255,0.05);
    }

    .vscode-explorer-header {
      padding: 10px 12px;
      font-size: 11px;
      font-weight: 600;
      color: rgba(255,255,255,0.6);
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .vscode-file {
      padding: 4px 12px 4px 24px;
      font-size: 13px;
      color: rgba(255,255,255,0.8);
      cursor: pointer;
    }

    .vscode-file:hover { background: rgba(255,255,255,0.05); }

    .vscode-editor {
      flex: 1;
      background: rgba(30,30,35,0.98);
      font-family: 'SF Mono', monospace;
      font-size: 12px;
      padding: 12px;
      color: rgba(255,255,255,0.9);
      line-height: 1.6;
      overflow-y: auto;
    }

    .code-keyword { color: #C586C0; }
    .code-function { color: #DCDCAA; }
    .code-string { color: #CE9178; }
    .code-comment { color: #6A9955; }
    .code-number { color: #B5CEA8; }

    /* Settings */
    .settings-container {
      display: flex;
      flex: 1;
      min-height: 350px;
    }

    .settings-sidebar {
      width: 220px;
      background: rgba(40,40,45,0.95);
      padding: 12px 0;
    }

    .settings-item {
      padding: 8px 16px;
      display: flex;
      align-items: center;
      gap: 10px;
      cursor: pointer;
      color: rgba(255,255,255,0.8);
      font-size: 13px;
    }

    .settings-item:hover { background: rgba(255,255,255,0.05); }
    .settings-item.active { background: rgba(0,122,255,0.3); }

    .settings-icon {
      width: 24px;
      height: 24px;
      border-radius: 6px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .settings-main {
      flex: 1;
      padding: 20px;
      background: rgba(30,30,35,0.95);
      overflow-y: auto;
    }

    .settings-section-title {
      font-size: 20px;
      font-weight: 600;
      color: white;
      margin-bottom: 20px;
    }

    .settings-option {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 12px 0;
      border-bottom: 1px solid rgba(255,255,255,0.05);
    }

    .settings-option-label {
      color: rgba(255,255,255,0.9);
      font-size: 13px;
    }

    .toggle-switch {
      width: 40px;
      height: 24px;
      background: rgba(120,120,130,0.3);
      border-radius: 12px;
      cursor: pointer;
      position: relative;
    }

    .toggle-switch.on { background: #32d74b; }

    .toggle-switch::after {
      content: '';
      position: absolute;
      width: 20px;
      height: 20px;
      background: white;
      border-radius: 50%;
      top: 2px;
      left: 2px;
      transition: transform 0.2s;
    }

    .toggle-switch.on::after { transform: translateX(16px); }

    /* About Me / Experience / Credits */
    .info-window {
      padding: 24px;
      color: rgba(255,255,255,0.9);
      flex: 1;
      overflow-y: auto;
    }

    .info-header {
      display: flex;
      align-items: center;
      gap: 16px;
      margin-bottom: 20px;
    }

    .info-avatar {
      width: 80px;
      height: 80px;
      border-radius: 20px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 32px;
      color: white;
    }

    .info-name {
      font-size: 24px;
      font-weight: 600;
      color: white;
    }

    .info-title {
      font-size: 14px;
      color: rgba(255,255,255,0.6);
      margin-top: 4px;
    }

    .info-section {
      margin-top: 20px;
    }

    .info-section-title {
      font-size: 12px;
      font-weight: 600;
      color: rgba(255,255,255,0.5);
      text-transform: uppercase;
      letter-spacing: 0.5px;
      margin-bottom: 8px;
    }

    .info-text {
      font-size: 14px;
      line-height: 1.6;
      color: rgba(255,255,255,0.85);
    }

    .experience-item {
      padding: 16px 0;
      border-bottom: 1px solid rgba(255,255,255,0.05);
    }

    .experience-role {
      font-weight: 600;
      color: white;
      font-size: 15px;
    }

    .experience-company {
      color: #007AFF;
      font-size: 13px;
      margin-top: 2px;
    }

    .experience-date {
      font-size: 12px;
      color: rgba(255,255,255,0.5);
      margin-top: 4px;
    }

    /* Spotify */
    .spotify-container {
      background: linear-gradient(180deg, #1a1a2e 0%, #121212 100%);
      min-height: 300px;
      padding: 20px;
      flex: 1;
    }

    .spotify-now-playing {
      display: flex;
      align-items: center;
      gap: 16px;
      margin-bottom: 24px;
    }

    .spotify-album-art {
      width: 120px;
      height: 120px;
      border-radius: 8px;
      background: linear-gradient(135deg, #1DB954 0%, #191414 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 48px;
      overflow: hidden;
      flex-shrink: 0;
    }

    .spotify-track-info { flex: 1; }

    .spotify-track-name {
      font-size: 20px;
      font-weight: 600;
      color: white;
    }

    .spotify-artist {
      font-size: 14px;
      color: rgba(255,255,255,0.6);
      margin-top: 4px;
    }

    .spotify-controls {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 24px;
      margin-top: 20px;
    }

    .spotify-btn {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background: transparent;
      border: none;
      color: white;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 20px;
    }

    .spotify-btn.play {
      width: 48px;
      height: 48px;
      background: #1DB954;
    }

    .spotify-progress {
      height: 4px;
      background: rgba(255,255,255,0.2);
      border-radius: 2px;
      margin-top: 16px;
      cursor: pointer;
    }

    .spotify-progress-bar {
      width: 0%;
      height: 100%;
      background: #1DB954;
      border-radius: 2px;
    }

    /* Mail */
    .mail-container {
      display: flex;
      flex: 1;
      min-height: 350px;
    }

    .mail-sidebar {
      width: 180px;
      background: rgba(40,40,45,0.95);
      padding: 12px 0;
    }

    .mail-folder {
      padding: 8px 16px;
      display: flex;
      align-items: center;
      gap: 8px;
      cursor: pointer;
      color: rgba(255,255,255,0.8);
      font-size: 13px;
    }

    .mail-folder:hover { background: rgba(255,255,255,0.05); }
    .mail-folder.active { background: rgba(0,122,255,0.3); }

    .mail-badge {
      background: #007AFF;
      color: white;
      font-size: 10px;
      padding: 2px 6px;
      border-radius: 10px;
      margin-left: auto;
    }

    .mail-list {
      width: 280px;
      background: rgba(35,35,40,0.95);
      border-right: 1px solid rgba(255,255,255,0.05);
      overflow-y: auto;
    }

    .mail-item {
      padding: 12px;
      border-bottom: 1px solid rgba(255,255,255,0.05);
      cursor: pointer;
    }

    .mail-item:hover { background: rgba(255,255,255,0.03); }

    .mail-sender {
      font-weight: 600;
      font-size: 13px;
      color: white;
    }

    .mail-subject {
      font-size: 12px;
      color: rgba(255,255,255,0.8);
      margin-top: 2px;
    }

    .mail-preview {
      font-size: 11px;
      color: rgba(255,255,255,0.5);
      margin-top: 4px;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }

    .mail-content {
      flex: 1;
      padding: 20px;
      background: rgba(30,30,35,0.95);
      overflow-y: auto;
    }

    /* Word-style Document */
    .word-toolbar {
      background: #2b579a;
      border-bottom: 1px solid #1e3f73;
    }

    .word-toolbar-tabs {
      display: flex;
      padding: 0 8px;
      background: #1e4a8a;
    }

    .word-tab {
      padding: 6px 16px;
      color: rgba(255,255,255,0.8);
      font-size: 12px;
      cursor: pointer;
    }

    .word-tab:hover {
      background: rgba(255,255,255,0.1);
    }

    .word-tab.active {
      background: #2b579a;
      color: white;
    }

    .word-toolbar-actions {
      display: flex;
      padding: 8px 12px;
      gap: 16px;
      background: #2b579a;
    }

    .word-tool-group {
      display: flex;
      gap: 2px;
    }

    .word-tool-btn {
      width: 28px;
      height: 28px;
      background: transparent;
      border: none;
      color: white;
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
      border-radius: 3px;
    }

    .word-tool-btn:hover {
      background: rgba(255,255,255,0.15);
    }

    .word-document-area {
      background: #525659;
      padding: 20px 40px;
      min-height: 400px;
      flex: 1;
      display: flex;
      justify-content: center;
      overflow-y: auto;
    }

    .word-page {
      width: 100%;
      max-width: 800px;
      min-height: 500px;
      background: white;
      box-shadow: 0 2px 10px rgba(0,0,0,0.3);
      padding: 40px 50px;
      color: #333;
      font-family: 'Calibri', 'Segoe UI', sans-serif;
      font-size: 14px;
      line-height: 1.6;
    }
  </style>
</head>
<body>
  <div class="wallpaper"></div>

  <!-- Menu Bar -->
  <div class="menu-bar">
    <div class="menu-left">
      <div class="apple-logo">
        <svg viewBox="0 0 384 512">
          <path d="M318.7 268.7c-.2-36.7 16.4-64.4 50-84.8-18.8-26.9-47.2-41.7-84.7-44.6-35.5-2.8-74.3 20.7-88.5 20.7-15 0-49.4-19.7-76.4-19.7C63.3 141.2 4 184.8 4 273.5q0 39.3 14.4 81.2c12.8 36.7 59 126.7 107.2 125.2 25.2-.6 43-17.9 75.8-17.9 31.8 0 48.3 17.9 76.4 17.9 48.6-.7 90.4-82.5 102.6-119.3-65.2-30.7-61.7-90-61.7-91.9zm-56.6-164.2c27.3-32.4 24.8-61.9 24-72.5-24.1 1.4-52 16.4-67.9 34.9-17.5 19.8-27.8 44.3-25.6 71.9 26.1 2 49.9-11.4 69.5-34.3z"/>
        </svg>
      </div>
      <span class="menu-item active" id="menu-app-name">Finder</span>
      <span class="menu-item">File</span>
      <span class="menu-item">Edit</span>
      <span class="menu-item">View</span>
      <span class="menu-item">Go</span>
      <span class="menu-item">Window</span>
      <span class="menu-item">Help</span>
    </div>
    <div class="menu-right">
      <div class="menu-icon battery">
        <span>100%</span>
        <div class="battery-icon">
          <div class="battery-body">
            <div class="battery-level"></div>
          </div>
          <div class="battery-cap"></div>
        </div>
      </div>
      <div class="menu-icon">
        <svg viewBox="0 0 24 24" fill="currentColor">
          <path d="M1 9l2 2c4.97-4.97 13.03-4.97 18 0l2-2C16.93 2.93 7.08 2.93 1 9zm8 8l3 3 3-3c-1.65-1.66-4.34-1.66-6 0zm-4-4l2 2c2.76-2.76 7.24-2.76 10 0l2-2C15.14 9.14 8.87 9.14 5 13z"/>
        </svg>
      </div>
      <div class="menu-icon">
        <svg viewBox="0 0 24 24" fill="currentColor">
          <path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/>
        </svg>
      </div>
      <span class="menu-icon menu-time" id="clock"></span>
    </div>
  </div>

  <!-- Terminal Window -->
  <div class="window active" id="window-terminal" style="top: 60px; left: 40px; width: 500px;">
    <div class="window-titlebar">
      <div class="window-controls">
        <div class="window-btn close"></div>
        <div class="window-btn minimize"></div>
        <div class="window-btn maximize"></div>
      </div>
      <span class="window-title">Terminal ‚Äî zsh</span>
    </div>
    <div class="terminal-content">
      <div><span class="terminal-prompt">apoorv@macbook</span> <span class="terminal-path">~/portfolio</span> % neofetch</div>
      <br>
      <div style="display: flex; gap: 20px;">
        <pre style="color: #5AC8FA; font-size: 10px; line-height: 1.2;">
                    'c.
                 ,xNMM.
               .OMMMMo
               OMMM0,
     .;loddo:' loolloddol;.
   cKMMMMMMMMMMNWMMMMMMMMMM0:
 .KMMMMMMMMMMMMMMMMMMMMMMMWd.
 XMMMMMMMMMMMMMMMMMMMMMMMX.
;MMMMMMMMMMMMMMMMMMMMMMMM:
:MMMMMMMMMMMMMMMMMMMMMMMM:
.MMMMMMMMMMMMMMMMMMMMMMMMX.
 kMMMMMMMMMMMMMMMMMMMMMMMMWd.
 .XMMMMMMMMMMMMMMMMMMMMMMMMMMk
  .XMMMMMMMMMMMMMMMMMMMMMMMMK.
    kMMMMMMMMMMMMMMMMMMMMMMd
     ;KMMMMMMMWXXWMMMMMMMk.
       .coeli
        </pre>
        <div style="font-size: 11px; line-height: 1.6;">
          <div><span style="color: #5AC8FA;">OS:</span> macOS Tahoe 26.0</div>
          <div><span style="color: #5AC8FA;">Host:</span> MacBook Pro</div>
          <div><span style="color: #5AC8FA;">Kernel:</span> Darwin 26.0.0</div>
          <div><span style="color: #5AC8FA;">Shell:</span> zsh 5.9</div>
          <div><span style="color: #5AC8FA;">Resolution:</span> 2560x1600</div>
          <div><span style="color: #5AC8FA;">DE:</span> Aqua</div>
          <div><span style="color: #5AC8FA;">Terminal:</span> Apple_Terminal</div>
          <div><span style="color: #5AC8FA;">CPU:</span> Apple M3 Pro</div>
          <div><span style="color: #5AC8FA;">Memory:</span> 8GB / 36GB</div>
        </div>
      </div>
      <br>
      <div><span class="terminal-prompt">apoorv@macbook</span> <span class="terminal-path">~/portfolio</span> % <span class="terminal-cursor"></span></div>
    </div>
  </div>

  <!-- Messages Window -->
  <div class="window" id="window-messages" style="top: 100px; left: 80px; width: 600px;">
    <div class="window-titlebar">
      <div class="window-controls">
        <div class="window-btn close"></div>
        <div class="window-btn minimize"></div>
        <div class="window-btn maximize"></div>
      </div>
      <span class="window-title">Messages</span>
    </div>
    <div class="messages-container">
      <div class="messages-sidebar">
        <div class="message-contact">
          <div class="contact-avatar">V</div>
          <div class="contact-info">
            <div class="contact-name">Vansh</div>
            <div class="contact-preview">Hey! How's the project?</div>
          </div>
        </div>
        <div class="message-contact">
          <div class="contact-avatar" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);">A</div>
          <div class="contact-info">
            <div class="contact-name">Aaru</div>
            <div class="contact-preview">Thanks for the help!</div>
          </div>
        </div>
      </div>
      <div class="messages-main">
        <div class="messages-area">
          <div class="message-bubble received">Hey! How's the project going?</div>
          <div class="message-bubble sent">Going great! Almost done with the UI.</div>
          <div class="message-bubble received">Awesome! Can't wait to see it üéâ</div>
          <div class="message-bubble sent">I'll share a preview soon!</div>
        </div>
        <div class="message-input">
          <input type="text" placeholder="iMessage">
        </div>
      </div>
    </div>
  </div>


  <!-- Spotify Window -->
  <div class="window" id="window-spotify" style="top: 110px; left: 200px; width: 450px;">
    <div class="window-titlebar">
      <div class="window-controls">
        <div class="window-btn close"></div>
        <div class="window-btn minimize"></div>
        <div class="window-btn maximize"></div>
      </div>
      <span class="window-title">Spotify</span>
    </div>
    <div class="spotify-container">
      <audio id="spotify-audio" src="../assets/Cupid.mp3" preload="metadata"></audio>
      <div class="spotify-now-playing">
        <div class="spotify-album-art">
          <img src="../assets/cupid.jpeg" alt="Cupid Album Art" style="width: 100%; height: 100%; object-fit: cover; border-radius: 8px;">
        </div>
        <div class="spotify-track-info">
          <div class="spotify-track-name">Cupid - Twin Version</div>
          <div class="spotify-artist">FIFTY FIFTY</div>
        </div>
      </div>
      <div class="spotify-progress" id="spotify-progress-container">
        <div class="spotify-progress-bar" id="spotify-progress-bar"></div>
      </div>
      <div style="display: flex; justify-content: space-between; font-size: 11px; color: rgba(255,255,255,0.5); margin-top: 4px;">
        <span id="spotify-current-time">0:00</span>
        <span id="spotify-duration">0:00</span>
      </div>
      <div class="spotify-controls">
        <button class="spotify-btn" id="spotify-prev">‚èÆ</button>
        <button class="spotify-btn play" id="spotify-play">‚ñ∂</button>
        <button class="spotify-btn" id="spotify-next">‚è≠</button>
      </div>
    </div>
  </div>

  <!-- Notes Window -->
  <div class="window" id="window-notes" style="top: 70px; left: 180px; width: 550px;">
    <div class="window-titlebar">
      <div class="window-controls">
        <div class="window-btn close"></div>
        <div class="window-btn minimize"></div>
        <div class="window-btn maximize"></div>
      </div>
      <span class="window-title">Notes</span>
    </div>
    <div class="notes-container">
      <div class="notes-sidebar">
        <div class="notes-item active">
          <div class="notes-title">Project Ideas</div>
          <div class="notes-preview">Build a macOS portfolio...</div>
        </div>
        <div class="notes-item">
          <div class="notes-title">Todo List</div>
          <div class="notes-preview">1. Finish portfolio 2. Update...</div>
        </div>
        <div class="notes-item">
          <div class="notes-title">Meeting Notes</div>
          <div class="notes-preview">Discussed new features...</div>
        </div>
      </div>
      <div class="notes-main">
        <h2 style="color: white; font-size: 20px; margin-bottom: 12px;">Project Ideas</h2>
        <p style="color: rgba(255,255,255,0.8); line-height: 1.6;">
          Build a macOS-style portfolio website<br><br>
          Features:<br>
          ‚Ä¢ Interactive desktop interface<br>
          ‚Ä¢ Functional windows with minimize/maximize<br>
          ‚Ä¢ Dock with app launching<br>
          ‚Ä¢ Multiple app previews<br><br>
          Status: In Progress ‚ú®
        </p>
      </div>
    </div>
  </div>

  <!-- VS Code Window -->
  <div class="window" id="window-vscode" style="top: 50px; left: 100px; width: 700px;">
    <div class="window-titlebar" style="background: #323233;">
      <div class="window-controls">
        <div class="window-btn close"></div>
        <div class="window-btn minimize"></div>
        <div class="window-btn maximize"></div>
      </div>
      <span class="window-title">Visual Studio Code</span>
    </div>
    <div class="vscode-container">
      <div class="vscode-sidebar">
        <div class="vscode-sidebar-icon active">üìÅ</div>
        <div class="vscode-sidebar-icon">üîç</div>
        <div class="vscode-sidebar-icon">üîÄ</div>
        <div class="vscode-sidebar-icon">üêõ</div>
        <div class="vscode-sidebar-icon">üì¶</div>
      </div>
      <div class="vscode-explorer">
        <div class="vscode-explorer-header">Explorer</div>
        <div class="vscode-file">üìÅ src</div>
        <div class="vscode-file" style="padding-left: 36px;">üìÑ App.tsx</div>
        <div class="vscode-file" style="padding-left: 36px;">üìÑ index.ts</div>
        <div class="vscode-file">üìÅ components</div>
        <div class="vscode-file">üìÑ package.json</div>
        <div class="vscode-file">üìÑ README.md</div>
      </div>
      <div class="vscode-editor">
        <span class="code-keyword">import</span> React <span class="code-keyword">from</span> <span class="code-string">'react'</span>;<br><br>
        <span class="code-keyword">const</span> <span class="code-function">Portfolio</span> = () => {<br>
        &nbsp;&nbsp;<span class="code-keyword">return</span> (<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&lt;div className=<span class="code-string">"app"</span>&gt;<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;h1&gt;Welcome&lt;/h1&gt;<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="code-comment">// More components here</span><br>
        &nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br>
        &nbsp;&nbsp;);<br>
        };<br><br>
        <span class="code-keyword">export default</span> Portfolio;
      </div>
    </div>
  </div>

  <!-- Settings Window -->
  <div class="window" id="window-settings" style="top: 80px; left: 160px; width: 650px;">
    <div class="window-titlebar">
      <div class="window-controls">
        <div class="window-btn close"></div>
        <div class="window-btn minimize"></div>
        <div class="window-btn maximize"></div>
      </div>
      <span class="window-title">System Settings</span>
    </div>
    <div class="settings-container">
      <div class="settings-sidebar">
        <div class="settings-item active">
          <div class="settings-icon" style="background: linear-gradient(135deg, #5AC8FA, #007AFF);">‚öôÔ∏è</div>
          General
        </div>
        <div class="settings-item">
          <div class="settings-icon" style="background: linear-gradient(135deg, #FF9500, #FF5E3A);">üñ•Ô∏è</div>
          Appearance
        </div>
        <div class="settings-item">
          <div class="settings-icon" style="background: linear-gradient(135deg, #4CD964, #00C853);">üîî</div>
          Notifications
        </div>
        <div class="settings-item">
          <div class="settings-icon" style="background: linear-gradient(135deg, #FF2D55, #FF3B30);">üîí</div>
          Privacy
        </div>
      </div>
      <div class="settings-main">
        <div class="settings-section-title">General</div>
        <div class="settings-option">
          <span class="settings-option-label">Dark Mode</span>
          <div class="toggle-switch on"></div>
        </div>
        <div class="settings-option">
          <span class="settings-option-label">Notifications</span>
          <div class="toggle-switch on"></div>
        </div>
        <div class="settings-option">
          <span class="settings-option-label">Auto-update</span>
          <div class="toggle-switch"></div>
        </div>
        <div class="settings-option">
          <span class="settings-option-label">Sound Effects</span>
          <div class="toggle-switch on"></div>
        </div>
      </div>
    </div>
  </div>

  <!-- About Me Window -->
  <div class="window" id="window-about" style="top: 70px; left: 140px; width: 500px;">
    <div class="window-titlebar">
      <div class="window-controls">
        <div class="window-btn close"></div>
        <div class="window-btn minimize"></div>
        <div class="window-btn maximize"></div>
      </div>
      <span class="window-title">About Me</span>
    </div>
    <div class="info-window">
      <div class="info-header">
        <div class="info-avatar">üë®‚Äçüíª</div>
        <div>
          <div class="info-name">Apoorv Darshan</div>
          <div class="info-title">Full Stack Developer</div>
        </div>
      </div>
      <div class="info-section">
        <div class="info-section-title">About</div>
        <div class="info-text">
          Passionate developer creating beautiful and functional web experiences.
          I love building products that make a difference and exploring new technologies.
        </div>
      </div>
      <div class="info-section">
        <div class="info-section-title">Skills</div>
        <div class="info-text">
          React ‚Ä¢ TypeScript ‚Ä¢ Node.js ‚Ä¢ Python ‚Ä¢ AWS ‚Ä¢ Docker
        </div>
      </div>
    </div>
  </div>

  <!-- Experience Window (Word-style) -->
  <div class="window" id="window-experience" style="top: 60px; left: 120px; width: 650px;">
    <div class="window-titlebar" style="background: #2b579a;">
      <div class="window-controls">
        <div class="window-btn close"></div>
        <div class="window-btn minimize"></div>
        <div class="window-btn maximize"></div>
      </div>
      <span class="window-title">Experience.docx - Word</span>
    </div>
    <!-- Word Toolbar -->
    <div class="word-toolbar">
      <div class="word-toolbar-tabs">
        <span class="word-tab active">Home</span>
        <span class="word-tab">Insert</span>
        <span class="word-tab">Layout</span>
        <span class="word-tab">View</span>
      </div>
      <div class="word-toolbar-actions">
        <div class="word-tool-group">
          <button class="word-tool-btn">B</button>
          <button class="word-tool-btn" style="font-style: italic;">I</button>
          <button class="word-tool-btn" style="text-decoration: underline;">U</button>
        </div>
        <div class="word-tool-group">
          <button class="word-tool-btn">‚â°</button>
          <button class="word-tool-btn">‚â°</button>
          <button class="word-tool-btn">‚â°</button>
        </div>
      </div>
    </div>
    <!-- Word Document Area -->
    <div class="word-document-area">
      <div class="word-page">
        <!-- Blank page content will go here -->
      </div>
    </div>
  </div>


  <!-- Credits Window -->
  <div class="window" id="window-credits" style="top: 80px; left: 160px; width: 450px;">
    <div class="window-titlebar">
      <div class="window-controls">
        <div class="window-btn close"></div>
        <div class="window-btn minimize"></div>
        <div class="window-btn maximize"></div>
      </div>
      <span class="window-title">Credits</span>
    </div>
    <div class="info-window">
      <h2 style="color: white; font-size: 20px; margin-bottom: 16px;">Credits & Acknowledgments</h2>
      <div class="info-text">
        <p><strong>Design Inspiration:</strong> Apple macOS</p>
        <p style="margin-top: 12px;"><strong>Icons:</strong> SF Symbols, Custom designs</p>
        <p style="margin-top: 12px;"><strong>Built with:</strong> HTML, CSS, JavaScript</p>
        <p style="margin-top: 12px;"><strong>Created by:</strong> Apoorv Darshan</p>
        <p style="margin-top: 20px; color: rgba(255,255,255,0.5);">Thank you for visiting! ‚ù§Ô∏è</p>
      </div>
    </div>
  </div>

  <!-- Desktop Icons -->
  <div class="desktop" id="desktop">
    <div class="desktop-icons-container">
      <div class="desktop-column">
        <div class="desktop-icon" data-window="about">
          <div class="icon-wrapper">
            <img src="icons/instagram.png" alt="About Me" class="desktop-icon-img">
          </div>
          <span class="icon-label">About Me</span>
        </div>

        <div class="desktop-icon" data-window="experience">
          <div class="icon-wrapper">
            <img src="icons/word.png" alt="Experience" class="desktop-icon-img">
          </div>
          <span class="icon-label">Experience</span>
        </div>

        <div class="desktop-icon" data-link="resume.pdf">
          <div class="icon-wrapper">
            <img src="icons/pdf.png" alt="Resume" class="desktop-icon-img">
          </div>
          <span class="icon-label">Resume</span>
        </div>

        <div class="desktop-icon" data-window="credits">
          <div class="icon-wrapper">
            <img src="icons/notes.png" alt="Credits" class="desktop-icon-img">
          </div>
          <span class="icon-label">Credits</span>
        </div>

        <div class="desktop-icon" data-action="projects">
          <div class="icon-wrapper">
            <img src="icons/folder.png" alt="Projects" class="desktop-icon-img">
          </div>
          <span class="icon-label">Projects</span>
        </div>

        <div class="desktop-icon" data-link="https://x.com/apoorvdarshan">
          <div class="icon-wrapper">
            <img src="icons/x.png" alt="X" class="desktop-icon-img">
          </div>
          <span class="icon-label">X</span>
        </div>

        <div class="desktop-icon" data-link="https://cal.com/apoorvdarshan">
          <div class="icon-wrapper">
            <img src="icons/meet.png" alt="Meet" class="desktop-icon-img">
          </div>
          <span class="icon-label">Meet</span>
        </div>
      </div>
    </div>
  </div>

  <!-- Dock -->
  <div class="dock-wrapper">
    <div class="dock">
      <div class="dock-item-container">
        <span class="dock-tooltip">Finder</span>
        <div class="dock-item" data-app="finder">
          <img src="icons/finder.png" alt="Finder">
        </div>
        <div class="dock-indicator active"></div>
      </div>

      <div class="dock-item-container">
        <span class="dock-tooltip">Messages</span>
        <div class="dock-item" data-app="messages">
          <img src="icons/messages.png" alt="Messages">
        </div>
        <div class="dock-indicator" id="indicator-messages"></div>
      </div>

      <div class="dock-item-container">
        <span class="dock-tooltip">Mail</span>
        <div class="dock-item" data-link="mailto:ad13dtu@gmail.com">
          <img src="icons/mail.png" alt="Mail">
        </div>
      </div>

      <div class="dock-item-container">
        <span class="dock-tooltip">Spotify</span>
        <div class="dock-item" data-app="spotify">
          <img src="icons/spotify.png" alt="Spotify">
        </div>
        <div class="dock-indicator" id="indicator-spotify"></div>
      </div>

      <div class="dock-separator"></div>

      <div class="dock-item-container">
        <span class="dock-tooltip">VS Code</span>
        <div class="dock-item" data-app="vscode">
          <img src="icons/vscode.png" alt="VS Code">
        </div>
        <div class="dock-indicator" id="indicator-vscode"></div>
      </div>

      <div class="dock-item-container">
        <span class="dock-tooltip">Terminal</span>
        <div class="dock-item" data-app="terminal">
          <img src="icons/terminal.png" alt="Terminal">
        </div>
        <div class="dock-indicator active" id="indicator-terminal"></div>
      </div>

      <div class="dock-separator"></div>

      <div class="dock-item-container">
        <span class="dock-tooltip">System Settings</span>
        <div class="dock-item" data-app="settings">
          <img src="icons/settings.png" alt="Settings">
        </div>
        <div class="dock-indicator" id="indicator-settings"></div>
      </div>
    </div>
  </div>

  <script>
    // Clock
    function updateClock() {
      const now = new Date();
      const days = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
      const months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
      document.getElementById('clock').textContent =
        `${days[now.getDay()]} ${months[now.getMonth()]} ${now.getDate()} ${now.getHours() % 12 || 12}:${now.getMinutes().toString().padStart(2, '0')} ${now.getHours() >= 12 ? 'PM' : 'AM'}`;
    }
    updateClock();
    setInterval(updateClock, 1000);

    // Window management
    let zIndex = 10;
    let activeWindow = null;

    // Get all windows
    const windows = {
      terminal: document.getElementById('window-terminal'),
      messages: document.getElementById('window-messages'),
      spotify: document.getElementById('window-spotify'),
      notes: document.getElementById('window-notes'),
      vscode: document.getElementById('window-vscode'),
      settings: document.getElementById('window-settings'),
      about: document.getElementById('window-about'),
      experience: document.getElementById('window-experience'),
      credits: document.getElementById('window-credits')
    };

    // App name mapping for menu bar
    const appNames = {
      terminal: 'Terminal',
      messages: 'Messages',
      spotify: 'Spotify',
      notes: 'Notes',
      vscode: 'Code',
      settings: 'System Settings',
      about: 'About Me',
      experience: 'Experience',
      resume: 'Preview',
      credits: 'Notes'
    };

    // Focus window
    function focusWindow(appName) {
      const win = windows[appName];
      if (!win) return;

      zIndex++;
      win.style.zIndex = zIndex;

      // Update active states
      Object.values(windows).forEach(w => w.classList.remove('focused'));
      win.classList.add('focused');

      // Update menu bar
      document.getElementById('menu-app-name').textContent = appNames[appName] || 'Finder';
      activeWindow = appName;
    }

    // Open window
    function openWindow(appName) {
      const win = windows[appName];
      if (!win) return;

      win.classList.add('active');
      win.classList.remove('minimized');
      focusWindow(appName);

      // Update dock indicator
      const indicator = document.getElementById(`indicator-${appName}`);
      if (indicator) indicator.classList.add('active');
    }

    // Close window
    function closeWindow(appName) {
      const win = windows[appName];
      if (!win) return;

      win.classList.remove('active', 'minimized', 'fullscreen', 'focused');

      // Update dock indicator
      const indicator = document.getElementById(`indicator-${appName}`);
      if (indicator) indicator.classList.remove('active');

      // Reset menu bar
      document.getElementById('menu-app-name').textContent = 'Finder';
    }

    // Minimize window
    function minimizeWindow(appName) {
      const win = windows[appName];
      if (!win) return;
      win.classList.add('minimized');
    }

    // Maximize/restore window
    function toggleMaximize(appName) {
      const win = windows[appName];
      if (!win) return;
      win.classList.toggle('fullscreen');
    }

    // Setup window controls for all windows
    Object.keys(windows).forEach(appName => {
      const win = windows[appName];
      if (!win) return;

      const controls = win.querySelector('.window-controls');
      if (!controls) return;

      const [closeBtn, minBtn, maxBtn] = controls.querySelectorAll('.window-btn');

      closeBtn.addEventListener('click', (e) => {
        e.stopPropagation();
        closeWindow(appName);
      });

      minBtn.addEventListener('click', (e) => {
        e.stopPropagation();
        minimizeWindow(appName);
      });

      maxBtn.addEventListener('click', (e) => {
        e.stopPropagation();
        toggleMaximize(appName);
      });

      // Click to focus
      win.addEventListener('mousedown', () => focusWindow(appName));
    });

    // Dock clicks
    document.querySelectorAll('.dock-item').forEach(item => {
      item.addEventListener('click', () => {
        const appName = item.dataset.app;
        const link = item.dataset.link;

        // Handle external links (including mailto)
        if (link) {
          window.open(link, '_blank');
          return;
        }

        if (!appName || appName === 'finder') return;

        const win = windows[appName];
        if (!win) return;

        if (!win.classList.contains('active')) {
          openWindow(appName);
        } else if (win.classList.contains('minimized')) {
          win.classList.remove('minimized');
          focusWindow(appName);
        } else {
          focusWindow(appName);
        }
      });
    });

    // Desktop icon clicks
    let selectedIcon = null;

    document.querySelectorAll('.desktop-icon').forEach(icon => {
      icon.addEventListener('click', (e) => {
        e.stopPropagation();
        if (selectedIcon) selectedIcon.classList.remove('selected');
        icon.classList.add('selected');
        selectedIcon = icon;
        window.parent.postMessage('mousedown', '*');
      });

      icon.addEventListener('dblclick', () => {
        const windowName = icon.dataset.window;
        const action = icon.dataset.action;
        const link = icon.dataset.link;

        if (windowName) {
          openWindow(windowName);
        } else if (action === 'projects') {
          window.parent.postMessage('Projects', '*');
        } else if (link) {
          window.open(link, '_blank');
        }
        window.parent.postMessage('mouseup', '*');
      });
    });

    // Click desktop to deselect
    document.getElementById('desktop').addEventListener('click', (e) => {
      if (e.target.id === 'desktop' || e.target.classList.contains('desktop-column') || e.target.classList.contains('desktop-icons-container')) {
        if (selectedIcon) {
          selectedIcon.classList.remove('selected');
          selectedIcon = null;
        }
      }
    });

    // Window dragging
    let isDragging = false;
    let dragWindow = null;
    let dragOffsetX = 0;
    let dragOffsetY = 0;

    // Setup dragging for all windows
    document.querySelectorAll('.window-titlebar').forEach(titlebar => {
      titlebar.addEventListener('mousedown', (e) => {
        // Don't drag if clicking on window controls
        if (e.target.classList.contains('window-btn')) return;

        const win = titlebar.closest('.window');
        if (!win || win.classList.contains('fullscreen')) return;

        isDragging = true;
        dragWindow = win;

        const rect = win.getBoundingClientRect();
        dragOffsetX = e.clientX - rect.left;
        dragOffsetY = e.clientY - rect.top;

        // Focus window
        const appName = win.id.replace('window-', '');
        focusWindow(appName);

        e.preventDefault();
      });
    });

    document.addEventListener('mousemove', (e) => {
      if (!isDragging || !dragWindow) return;

      let newX = e.clientX - dragOffsetX;
      let newY = e.clientY - dragOffsetY;

      // Keep window within bounds (above dock which is ~70px)
      const minY = 25; // Below menu bar
      const maxY = window.innerHeight - dragWindow.offsetHeight - 70; // Above dock

      newX = Math.max(0, Math.min(newX, window.innerWidth - 100));
      newY = Math.max(minY, Math.min(newY, maxY));

      dragWindow.style.left = newX + 'px';
      dragWindow.style.top = newY + 'px';
    });

    document.addEventListener('mouseup', () => {
      isDragging = false;
      dragWindow = null;
    });

    // Parent events
    document.addEventListener('mousedown', () => window.parent.postMessage('mousedown', '*'));
    document.addEventListener('mouseup', () => window.parent.postMessage('mouseup', '*'));

    // Spotify Player
    const spotifyAudio = document.getElementById('spotify-audio');
    const spotifyPlayBtn = document.getElementById('spotify-play');
    const spotifyProgressBar = document.getElementById('spotify-progress-bar');
    const spotifyProgressContainer = document.getElementById('spotify-progress-container');
    const spotifyCurrentTime = document.getElementById('spotify-current-time');
    const spotifyDuration = document.getElementById('spotify-duration');
    let isPlaying = false;

    function formatTime(seconds) {
      const mins = Math.floor(seconds / 60);
      const secs = Math.floor(seconds % 60);
      return `${mins}:${secs.toString().padStart(2, '0')}`;
    }

    spotifyAudio.addEventListener('loadedmetadata', () => {
      spotifyDuration.textContent = formatTime(spotifyAudio.duration);
    });

    spotifyAudio.addEventListener('timeupdate', () => {
      const progress = (spotifyAudio.currentTime / spotifyAudio.duration) * 100;
      spotifyProgressBar.style.width = `${progress}%`;
      spotifyCurrentTime.textContent = formatTime(spotifyAudio.currentTime);
    });

    spotifyAudio.addEventListener('ended', () => {
      isPlaying = false;
      spotifyPlayBtn.textContent = '‚ñ∂';
      spotifyProgressBar.style.width = '0%';
      spotifyCurrentTime.textContent = '0:00';
    });

    spotifyPlayBtn.addEventListener('click', () => {
      if (isPlaying) {
        spotifyAudio.pause();
        spotifyPlayBtn.textContent = '‚ñ∂';
      } else {
        spotifyAudio.play();
        spotifyPlayBtn.textContent = '‚è∏';
      }
      isPlaying = !isPlaying;
    });

    spotifyProgressContainer.addEventListener('click', (e) => {
      const rect = spotifyProgressContainer.getBoundingClientRect();
      const clickX = e.clientX - rect.left;
      const width = rect.width;
      const percent = clickX / width;
      spotifyAudio.currentTime = percent * spotifyAudio.duration;
    });
  </script>
</body>
</html>
