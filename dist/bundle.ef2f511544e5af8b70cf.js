"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[792],{267:(e,t,i)=>{var s=i(437);const n=class{constructor(){this.callbacks={},this.callbacks.base={}}on(e,t){const i=this;if(void 0===e||""===e)return!1;if(void 0===t)return!1;return this.resolveNames(e).forEach((function(e){const s=i.resolveName(e);i.callbacks[s.namespace]instanceof Object||(i.callbacks[s.namespace]={}),i.callbacks[s.namespace][s.value]instanceof Array||(i.callbacks[s.namespace][s.value]=[]),i.callbacks[s.namespace][s.value].push(t)})),this}off(e){const t=this;if(void 0===e||""===e)return!1;return this.resolveNames(e).forEach((function(e){const i=t.resolveName(e);if("base"!==i.namespace&&""===i.value)delete t.callbacks[i.namespace];else if("base"===i.namespace)for(const e in t.callbacks)t.callbacks[e]instanceof Object&&t.callbacks[e][i.value]instanceof Array&&(delete t.callbacks[e][i.value],0===Object.keys(t.callbacks[e]).length&&delete t.callbacks[e]);else t.callbacks[i.namespace]instanceof Object&&t.callbacks[i.namespace][i.value]instanceof Array&&(delete t.callbacks[i.namespace][i.value],0===Object.keys(t.callbacks[i.namespace]).length&&delete t.callbacks[i.namespace])})),this}trigger(e,t){if(void 0===e||""===e)return!1;const i=this;let s=null,n=null;const o=t instanceof Array?t:[];let a=this.resolveNames(e);if(a=this.resolveName(a[0]),"base"===a.namespace)for(const e in i.callbacks)i.callbacks[e]instanceof Object&&i.callbacks[e][a.value]instanceof Array&&i.callbacks[e][a.value].forEach((function(e){n=e.apply(i,o),void 0===s&&(s=n)}));else if(this.callbacks[a.namespace]instanceof Object){if(""===a.value)return this;i.callbacks[a.namespace][a.value].forEach((function(e){n=e.apply(i,o),void 0===s&&(s=n)}))}return s}resolveNames(e){let t=e;return t=t.replace(/[^a-zA-Z0-9 ,/.]/g,""),t=t.replace(/[,/]+/g," "),t=t.split(" "),t}resolveName(e){const t={},i=e.split(".");return t.original=e,t.value=i[0],t.namespace="base",i.length>1&&""!==i[1]&&(t.namespace=i[1]),t}};class o extends n{constructor(){super(),this.start=Date.now(),this.current=this.start,this.elapsed=0,this.delta=16,this.playing=!0,this.tick=this.tick.bind(this),this.tick()}play(){this.playing=!0}pause(){this.playing=!1}tick(){this.ticker=window.requestAnimationFrame(this.tick);const e=Date.now();this.delta=e-this.current,this.elapsed+=this.playing?this.delta:0,this.current=e,this.delta>60&&(this.delta=60),this.playing&&this.trigger("tick")}stop(){window.cancelAnimationFrame(this.ticker)}}class a extends n{constructor(){super(),this.viewport={},this.$sizeViewport=document.createElement("div"),this.$sizeViewport.style.width="100vw",this.$sizeViewport.style.height="100vh",this.$sizeViewport.style.position="absolute",this.$sizeViewport.style.top=0,this.$sizeViewport.style.left=0,this.$sizeViewport.style.pointerEvents="none",this.resize=this.resize.bind(this),window.addEventListener("resize",this.resize),this.resize()}resize(){document.body.appendChild(this.$sizeViewport),this.viewport.width=this.$sizeViewport.offsetWidth,this.viewport.height=this.$sizeViewport.offsetHeight,document.body.removeChild(this.$sizeViewport),this.width=window.innerWidth,this.height=window.innerHeight,this.trigger("resize")}}var r=i(92),c=i(933),h=i(728),l=i(231),d=i(263);var u=i(880);class p extends n{constructor(){super(),this.banner=document.querySelector(".banner"),this.loadingScreen=document.querySelector(".loadingScreen"),this.audioButton=document.querySelector(".audio-button"),this.loadingScreen.classList.add("show-loading-screen"),this.experience=new Fe,this.renderer=this.experience.renderer.instance,this.scene=this.experience.scene,this.camera=this.experience.camera.instance,this.resourcesLoaded=!1,this.setOverlayLoading(),this.setLoaders(),this.toLoad=0,this.loaded=0,this.items={}}handleLoadError(e,t){this.fileLoadEnd(e,null)}setLoaders(){this.loaders=[],this.loaders.push({extensions:["jpg","png"],action:e=>{const t=new Image;t.addEventListener("load",(()=>{this.fileLoadEnd(e,t)})),t.addEventListener("error",(t=>{this.handleLoadError(e,t)})),t.src=e.source}}),this.loaders.push({extensions:["cubeTexture"],action:e=>{(new s.ScU).load(e.source,(t=>{this.fileLoadEnd(e,t)}),void 0,(t=>{this.handleLoadError(e,t)}))}});const e=new d.p;e.setTranscoderPath("basis/"),e.detectSupport(this.renderer),this.loaders.push({extensions:["ktx2"],action:t=>{e.load(t.source,(e=>{this.fileLoadEnd(t,e)}),void 0,(e=>{this.handleLoadError(t,e)}))}});const t=new h.Z;t.setDecoderPath("draco/"),t.setDecoderConfig({type:"js"}),this.loaders.push({extensions:["drc"],action:e=>{t.load(e.source,(t=>{this.fileLoadEnd(e,t),h.Z.releaseDecoderModule()}),void 0,(t=>{this.handleLoadError(e,t)}))}});const i=new r.B;i.setDRACOLoader(t),this.loaders.push({extensions:["glb","gltf"],action:e=>{i.load(e.source,(t=>{this.fileLoadEnd(e,t)}),void 0,(t=>{this.handleLoadError(e,t)}))}});const n=new c.w;this.loaders.push({extensions:["fbx"],action:e=>{n.load(e.source,(t=>{this.fileLoadEnd(e,t)}),void 0,(t=>{this.handleLoadError(e,t)}))}});const o=new l.Y;this.loaders.push({extensions:["hdr"],action:e=>{o.load(e.source,(t=>{this.fileLoadEnd(e,t)}),void 0,(t=>{this.handleLoadError(e,t)}))}});const a=new s.Am1;this.loaders.push({extensions:["mp3","ogg"],action:e=>{a.load(e.source,(t=>{this.fileLoadEnd(e,t)}),void 0,(t=>{this.handleLoadError(e,t)}))}})}setOverlayLoading(){this.overlayGeometry=new s.bdM(2,2,1,1),this.overlayMaterial=new s.BKk({transparent:!0,depthTest:!1,uniforms:{uColor:{value:new s.Q1f(0)},uAlpha:{value:1}},vertexShader:"#define GLSLIFY 1\nvoid main()\n{\n    gl_Position = vec4(position, 1.0);\n}",fragmentShader:"#define GLSLIFY 1\nuniform float uAlpha;\nuniform vec3 uColor;\n\nvoid main()\n{\n    gl_FragColor = vec4(uColor, uAlpha);\n}"}),this.overlay=new s.eaF(this.overlayGeometry,this.overlayMaterial),this.scene.add(this.overlay)}removeOverlay=()=>{u.os.to(this.overlayMaterial.uniforms.uAlpha,{duration:.5,value:0,delay:1,ease:"sine.in",onComplete:()=>{this.overlayGeometry.dispose(),this.overlayMaterial.dispose(),this.scene.remove(this.overlay),this.resourcesLoaded=!0},onStart:()=>{this.banner.style.top="0px",this.experience.navigation.orbitControls.enabled=!0}})};load(e=[]){for(const t of e){this.toLoad++;const e=this.loaders.find((e=>{if("cubeTexture"===t.type)return e.extensions.includes("cubeTexture");{const i=t.source.match(/\.([a-zA-Z0-9]+)$/),s=i?i[1]:null;return s&&e.extensions.includes(s)}}));if(e)e.action(t);else if("cubeTexture"===t.type);else{const e=t.source.match(/\.([a-zA-Z0-9]+)$/);e&&e[1]}}}fileLoadEnd(e,t){this.loaded++,this.items[e.name]=t;const i=this.loaded/this.toLoad*360;this.loadingScreen.style.setProperty("--p",i+"deg"),this.loaded==this.toLoad&&(this.loadingScreen.classList.add("finished-load"),setTimeout((()=>{this.loadingScreen.textContent="START",this.loadingScreen.style.cursor="pointer",this.loadingScreen.classList.add("loading-screen-hover"),this.loadingScreen.classList.remove("finished-load");const e=()=>{const t=this.experience.world.audioManager;t.playSingleAudio("start",.4),t.playLoopAudio("floral",.1),this.audioButton.classList.add("show-audio-button"),this.loadingScreen.classList.remove("show-loading-screen"),this.removeOverlay(),this.loadingScreen.removeEventListener("click",e)};this.loadingScreen.addEventListener("click",e)}),1e3)),this.trigger("fileEnd",[e,t]),this.loaded===this.toLoad&&this.trigger("end")}}class m extends n{constructor(e){super(),this.items={},this.loader=new p({renderer:this.renderer}),this.groups={},this.groups.assets=[...e],this.groups.loaded=[],this.groups.current=null,this.loadNextGroup(),this.loader.on("fileEnd",((e,t)=>{let i=t;"texture"===e.type&&(i instanceof s.gPd||(i=new s.gPd(t)),i.needsUpdate=!0),this.items[e.name]=i,this.groups.current.loaded++,this.trigger("progress",[this.groups.current,e,i])})),this.loader.on("end",(()=>{this.groups.loaded.push(this.groups.current),this.trigger("groupEnd",[this.groups.current]),this.groups.assets.length>0?this.loadNextGroup():this.trigger("end")}))}loadNextGroup(){this.groups.current=this.groups.assets.shift(),this.groups.current.toLoad=this.groups.current.items.length,this.groups.current.loaded=0,this.loader.load(this.groups.current.items)}createInstancedMeshes(e,t){const i=[];for(const e of t)i.push({name:e.name,regex:e.regex,meshesGroups:[],instancedMeshes:[]});const s={};for(const e of i)s[e.name]=e.instancedMeshes;return s}destroy(){for(const e in this.items){const t=this.items[e];t instanceof s.gPd&&t.dispose()}}}var g=i(439),b=i(804),w=i(411),v=i(742),y=i(185),f=i(450),x=i(370);const M={low:{pixelRatioMultiplier:.5,usePostprocess:!1,useSMAA:!1,samples:2},medium:{pixelRatioMultiplier:.75,usePostprocess:!0,useSMAA:!1,samples:4},high:{pixelRatioMultiplier:1,usePostprocess:!0,useSMAA:!0,samples:8}};class k{constructor(e={}){this.experience=new Fe,this.webglElement=this.experience.webglElement,this.cssArcadeMachine=this.experience.cssArcadeMachine,this.cssLeftMonitor=this.experience.cssLeftMonitor,this.cssRightMonitor=this.experience.cssRightMonitor,this.config=this.experience.config,this.sizes=this.experience.sizes,this.scene=this.experience.scene,this.camera=this.experience.camera,this.cssArcadeMachineScene=this.experience.cssArcadeMachineScene,this.cssLeftMonitorScene=this.experience.cssLeftMonitorScene,this.cssRightMonitorScene=this.experience.cssRightMonitorScene,this.qualityLevel=this.detectQualityLevel(),this.qualitySettings=M[this.qualityLevel],this.usePostprocess=this.qualitySettings.usePostprocess,this.setInstance(),this.setPostProcess()}detectQualityLevel(){const e=document.createElement("canvas").getContext("webgl"),t=e?.getExtension("WEBGL_debug_renderer_info"),i=t?e.getParameter(t.UNMASKED_RENDERER_WEBGL):"",s=/Intel|Mali|Adreno|PowerVR/i.test(i)||navigator.hardwareConcurrency<=4||window.devicePixelRatio<1.5,n=!s&&(navigator.hardwareConcurrency<=8||window.devicePixelRatio<2);return s?"low":n?"medium":"high"}setQuality(e){if(!M[e])return;this.qualityLevel=e,this.qualitySettings=M[e],this.usePostprocess=this.qualitySettings.usePostprocess;const t=this.config.pixelRatio*this.qualitySettings.pixelRatioMultiplier;this.instance.setPixelRatio(t),this.postProcess.composer.setPixelRatio(t)}setInstance(){this.clearColor=new s.Q1f(0).convertSRGBToLinear(),this.instance=new s.JeP({antialias:"low"!==this.qualityLevel,powerPreference:"high-performance"}),this.instance.domElement.style.position="absolute",this.instance.domElement.style.top=0,this.instance.domElement.style.left=0,this.instance.domElement.style.width="100%",this.instance.domElement.style.height="100%";const e=this.config.pixelRatio*this.qualitySettings.pixelRatioMultiplier;this.instance.setClearColor(this.clearColor,1),this.instance.setSize(this.config.width,this.config.height),this.instance.setPixelRatio(e),this.instance.localClippingEnabled=!0,this.instance.outputColorSpace="srgb",this.webglElement.appendChild(this.instance.domElement),this.cssArcadeMachineInstance=new w.a0,this.cssArcadeMachineInstance.setSize(this.sizes.width,this.sizes.height),this.cssArcadeMachineInstance.domElement.style.position="absolute",this.cssArcadeMachineInstance.domElement.style.top="0px",this.cssLeftMonitorInstance=new w.a0,this.cssLeftMonitorInstance.setSize(this.sizes.width,this.sizes.height),this.cssLeftMonitorInstance.domElement.style.position="absolute",this.cssLeftMonitorInstance.domElement.style.top="0px",this.cssRightMonitorInstance=new w.a0,this.cssRightMonitorInstance.setSize(this.sizes.width,this.sizes.height),this.cssRightMonitorInstance.domElement.style.position="absolute",this.cssRightMonitorInstance.domElement.style.top="0px",this.cssArcadeMachine.appendChild(this.cssArcadeMachineInstance.domElement),this.cssLeftMonitor.appendChild(this.cssLeftMonitorInstance.domElement),this.cssRightMonitor.appendChild(this.cssRightMonitorInstance.domElement)}setPostProcess(){this.postProcess={},this.postProcess.renderPass=new b.A(this.scene,this.camera.instance),this.postProcess.outlinePass=new v.G(new s.I9Y(window.innerWidth,window.innerHeight),this.scene,this.camera.instance),this.postProcess.outlinePass.visibleEdgeColor.set(16777215),this.postProcess.outlinePass.hiddenEdgeColor.set(16777215),this.postProcess.outlinePass.edgeThickness=3,this.postProcess.outlinePass.edgeStrength=6;const e=this.qualitySettings.samples;this.renderTarget=new s.nWS(this.config.width,this.config.height,{samples:e,generateMipmaps:!1,minFilter:s.k6q,magFilter:s.k6q,colorSpace:"srgb"}),this.postProcess.composer=new g.s(this.instance,this.renderTarget);const t=this.config.pixelRatio*this.qualitySettings.pixelRatioMultiplier;if(this.postProcess.composer.setSize(this.config.width,this.config.height),this.postProcess.composer.setPixelRatio(t),this.gammaCorrectionShader=new y.p(x.Z),this.postProcess.composer.addPass(this.postProcess.renderPass),this.postProcess.composer.addPass(this.postProcess.outlinePass),this.postProcess.composer.addPass(this.gammaCorrectionShader),this.qualitySettings.useSMAA&&this.instance.capabilities.isWebGL2){const e=new f.I;this.postProcess.composer.addPass(e)}}resize(){this.instance.setSize(this.config.width,this.config.height),this.instance.setPixelRatio(this.config.pixelRatio),this.cssArcadeMachineInstance.setSize(this.config.width,this.config.height),this.cssLeftMonitorInstance.setSize(this.config.width,this.config.height),this.cssRightMonitorInstance.setSize(this.config.width,this.config.height),this.postProcess.composer.setSize(this.config.width,this.config.height),this.postProcess.composer.setPixelRatio(this.config.pixelRatio)}update(){this.usePostprocess?this.postProcess.composer.render():this.instance.render(this.scene,this.camera.instance),this.cssArcadeMachineInstance.render(this.cssArcadeMachineScene,this.camera.instance),this.cssLeftMonitorInstance.render(this.cssLeftMonitorScene,this.camera.instance),this.cssRightMonitorInstance.render(this.cssRightMonitorScene,this.camera.instance)}destroy(){this.instance.renderLists.dispose(),this.instance.dispose(),this.renderTarget.dispose(),this.postProcess.composer.renderTarget1.dispose(),this.postProcess.composer.renderTarget2.dispose()}}const S=1006.986,C=1210.118261733125,P=new s.Pq0(.00102,.00102,.00102),L=new s.Pq0(3.24776,2.7421,2.3009),E=-Math.PI/7,R=-Math.PI/2,A={uCurvature:new s.I9Y(3,3),uScreenResolution:new s.I9Y(201.3972,242.02365234662503),uScanLineOpacity:new s.I9Y(.5,.5),uBaseColor:new s.Q1f(.1,.1,.1).convertSRGBToLinear(),uColor:new s.Q1f(0,0,0).convertSRGBToLinear(),uVignetteOpacity:1,uBrightness:2.5,uVignetteRoundness:1},T=new s.Pq0(-1.7,5.5,2.3009),z=new s.PTz(-.17756084520729903,-.6844502511134536,-.17756084520729903,.6844502511134535),j=new s.Pq0(3.25776,2.74209,2.3009),I=new s.Pq0(-23,17,23),B=new s.PTz(-.19229498096591757,-.3743024144764491,-.07965118909235921,.9036459654580388),O=new s.Pq0(0,2.5,0),D={uColor:new s.Q1f(.7529412,.5424671,.4392157).convertSRGBToLinear(),uShellCount:32,uShellLength:.16,uDensity:250,uThickness:5},U=new s.Pq0(.0355,.0355,.0355),Y=new s.Pq0(-2.61408,.377,-.904327),F=new s.O9p(-Math.PI/2,0,0),V=new s.bdM(.15,.6,16,64),G=new s.Pq0(.230979,2.3,-3.64951),q=500,N=[15742297,15889075,10216690,16771934,16757504,8126347],_=1370.178,W=764.798,K=new s.Pq0(1.06738,2.50725,-4.23009),Z=new s.Pq0(.00102,.00102,1),H=new s.Pq0(1.06738,2.60725,-1.6),X=new s.PTz(0,-.06458455890406237,0,.9979122380005006),$=new s.Pq0(1.06738,2.50725,-4.23009),Q=new s.Pq0(2.47898,2.50716,-4.14566),J=new s.Pq0(.00102,.00102,1),ee=-7.406*Math.PI/180,te=new s.Pq0(2.13997,2.60716,-1.53751),ie=new s.PTz(-.018960792071729096,-.06457153090946945,-.0012271102383421897,.9977321784730022),se=new s.Pq0(2.47898,2.50716,-4.14566),ne=["rubikGroup","linkedin","github","itchio","arcadeMachine","arcadeMachineScreen","leftMonitor","leftMonitorScreen","rightMonitor","rightMonitorScreen","whiteboard","whiteboardCanvas"],oe={enabled:!1,screenSpacePanning:!0,enableKeys:!1,zoomSpeed:1,enableDamping:!0,dampingFactor:.05,rotateSpeed:.4,maxAzimuthAngle:2*Math.PI,minAzimuthAngle:-Math.PI/2,minPolarAngle:Math.PI/6,maxPolarAngle:Math.PI/2,minDistance:2,maxDistance:35,target:{y:2.5}},ae=new s.Pq0(-3.3927,5.18774,4.61366),re=new s.PTz(-.08802977047890838,0,0,.9961178441878403,1),ce=new s.Pq0(-3.3927,3.18774,-4.61366),he=new s.Pq0(0,0,0),le=-152.484*Math.PI/180,de=new s.Pq0(-.67868,1.499,-3.92849),ue=new s.Pq0(1.4027,.496728,-1.21048);class pe{constructor(){this.experience=new Fe,this.config=this.experience.config,this.scene=this.experience.scene,this.setInstance()}setInstance=()=>{this.instance=new s.ubm(20,this.config.width/this.config.height,.1,1e3),this.instance.rotation.reorder("YXZ"),this.instance.position.copy(I),this.scene.add(this.instance)};resize=()=>{this.instance.aspect=this.config.width/this.config.height,this.instance.updateProjectionMatrix()};update=()=>{this.instance.updateProjectionMatrix()}}class me{constructor(){this.experience=new Fe,this.resources=this.experience.resources,this.scene=this.experience.scene,this.renderer=this.experience.renderer.instance,this.maxAnisotropy=this.renderer.capabilities.getMaxAnisotropy(),this.setModels()}setMaterial=(e,t)=>{e.traverse((e=>{e.isMesh&&(e.material=t)}))};configureTexture=e=>(e.anisotropy=this.maxAnisotropy,e.colorSpace=s.er$,e.needsUpdate=!0,e);setModels=()=>{this.model={},this.model.room1=this.resources.items._roomModel.scene,this.bakedTexture1=this.configureTexture(this.resources.items.baked1),this.model.material=new s.V9B({map:this.bakedTexture1}),this.model.room2=this.resources.items._roomModel2.scene,this.bakedTexture2=this.configureTexture(this.resources.items.baked2),this.model.material2=new s.V9B({map:this.bakedTexture2}),this.model.room3=this.resources.items._roomModel3.scene,this.bakedTexture3=this.configureTexture(this.resources.items.baked3),this.model.material3=new s.V9B({map:this.bakedTexture3}),this.model.linkedin=this.resources.items.linkedin.scene,this.model.linkedin.name="linkedin",this.model.github=this.resources.items.github.scene,this.model.github.name="github",this.model.itchio=this.resources.items.itchio.scene,this.model.itchio.name="itchio",this.setMaterial(this.model.room1,this.model.material),this.setMaterial(this.model.room2,this.model.material2),this.setMaterial(this.model.room3,this.model.material3),this.setMaterial(this.model.linkedin,this.model.material3),this.setMaterial(this.model.github,this.model.material3),this.setMaterial(this.model.itchio,this.model.material3),this.scene.add(this.model.room1),this.scene.add(this.model.room2),this.scene.add(this.model.room3),this.scene.add(this.model.linkedin),this.scene.add(this.model.github),this.scene.add(this.model.itchio)}}class ge{constructor(){this.experience=new Fe,this.resources=this.experience.resources,this.scene=this.experience.scene,this.time=this.experience.time,this.setModel()}setModel=()=>{this.model={},this.model.perlinTexture=this.resources.items.perlin,this.model.perlinTexture.wrapS=s.GJx,this.model.perlinTexture.wrapT=s.GJx,this.model.material=new s.BKk({transparent:!0,depthWrite:!1,side:s.$EB,vertexShader:"#define GLSLIFY 1\nuniform float uTime;\nuniform sampler2D uPerlinTexture;\n\nvarying vec2 vUv;\n\nvec2 rotate2D(vec2 value, float angle)\n{\n    float s = sin(angle);\n    float c = cos(angle);\n    mat2 m = mat2(c, s, -s, c);\n    return m * value;\n}\n\nvoid main()\n{\n     vec3 newPosition = position;\n\n    // Twist\n    float twistPerlin = texture(\n        uPerlinTexture,\n        vec2(0.5, uv.y * 0.2 - uTime * 0.005)\n    ).r;\n    float angle = twistPerlin * 10.0;\n    newPosition.xz = rotate2D(newPosition.xz, angle);\n\n    // Wind\n    vec2 windOffset = vec2(\n        texture(uPerlinTexture, vec2(0.25, uTime * 0.01)).r - 0.5,\n        texture(uPerlinTexture, vec2(0.75, uTime * 0.01)).r - 0.5\n    );\n    windOffset *= pow(uv.y, 2.0) * 1.0;\n    newPosition.xz += windOffset; \n\n    // Final position\n    gl_Position = projectionMatrix * modelViewMatrix * vec4(newPosition, 1.0);\n\n    // Varyings\n    vUv = uv;\n}",fragmentShader:"#define GLSLIFY 1\nuniform float uTime;\nuniform sampler2D uPerlinTexture;\n\nvarying vec2 vUv;\n\nvoid main()\n{\n    // Scale and animate\n    vec2 smokeUv = vUv;\n    smokeUv.x *= 0.5;\n    smokeUv.y *= 0.3;\n    smokeUv.y -= uTime * 0.03; \n\n    // Smoke\n    float smoke = texture(uPerlinTexture, smokeUv).r;\n\n    // Remap\n    smoke = smoothstep(0.4, 1.0, smoke);\n\n    // Edges\n    smoke *= smoothstep(0.0, 0.1, vUv.x);\n    smoke *= smoothstep(1.0, 0.9, vUv.x);\n    smoke *= smoothstep(0.0, 0.1, vUv.y);\n    smoke *= smoothstep(1.0, 0.2, vUv.y);\n\n    // Final color\n    gl_FragColor = vec4(0.7,0.7,0.7, smoke);\n    #include <tonemapping_fragment>\n    #include <colorspace_fragment>\n}",uniforms:{uTime:{value:0},uPerlinTexture:{value:this.resources.items.perlin}}}),this.planeGeom=V,this.model.mesh=new s.eaF(this.planeGeom,this.model.material),this.model.mesh.position.copy(G),this.model.mesh.name="coffeeSteam",this.scene.add(this.model.mesh)};update=()=>{const e=this.experience.clock.getElapsedTime();this.model.material.uniforms.uTime.value=e}}class be{constructor(){this.experience=new Fe,this.resources=this.experience.resources,this.scene=this.experience.scene,this.world=this.experience.world,this.time=this.experience.time,this.materialTopChair=this.experience.world.baked.model.material2,this.setModel(),this.startAnimation()}setModel(){this.model={},this.model.group=this.resources.items.topChairModel.scene,this.model.group.position.copy(ue),this.scene.add(this.model.group),this.model.group.traverse((e=>{e.isMesh&&(e.material=this.materialTopChair)}))}startAnimation(){this.startTime=Date.now(),this.update()}update(){if(!this.startTime)return;const e=Date.now()-this.startTime;this.model.group.rotation.y=.5*Math.sin(3e-4*e)}}class we{constructor(){this.experience=new Fe,this.webglElement=this.experience.webglElement,this.resources=this.experience.resources,this.scene=this.experience.scene,this.renderer=this.experience.renderer.instance,this.camera=this.experience.camera,this.audioManager=this.experience.world.audioManager,this.mouse=this.experience.mouse,this.baked=this.experience.world.baked,this.whiteboardGroup=new s.YJl,this.drawStartPos=new s.I9Y(-1,-1),this.raycaster=this.experience.raycaster,this.drawColor="black",this.isActive=!1,this.positionsToDraw=[],this.model={},this.materialWhiteboard=this.experience.world.baked.model.material,this.setModel(),this.setWhiteboard()}setModel(){this.whiteboardButtons=document.querySelectorAll(".circular-button-whiteboard"),this.whiteboardButtons.forEach((e=>{e.addEventListener("click",(()=>{this.changeWhiteboardColor(e.id),this.whiteboardButtons.forEach((e=>{e.classList.remove("whiteboard-selected")})),"eraser"!=e.id?this.audioManager.playSingleAudio("markerOpen",.8):this.audioManager.playSingleAudio("eraser",.3),e.classList.add("whiteboard-selected")}))})),this.model.mesh=this.resources.items.whiteboard.scene,this.model.mesh.traverse((e=>{e.isMesh&&(e.material=this.materialWhiteboard)})),this.whiteboardGroup.add(this.model.mesh),this.model.mesh.name="whiteboard",this.scene.add(this.model.mesh)}setWhiteboard(){this.whiteboardMaterial=new s.V9B;const e=new s.bdM(2.6,1.82);e.computeBoundingBox(),e.computeVertexNormals();const t=new s.eaF(e,this.whiteboardMaterial);t.position.set(-3.3927,3.18774,-4.61366),t.name="whiteboardCanvas",this.model.mesh.add(t);const i=this.resources.items.texture_paint.source.data;i.src=i.src,this.drawingCanvas=document.getElementById("drawing-canvas"),this.drawingContext=this.drawingCanvas.getContext("2d"),i.onload=()=>{this.drawingContext.drawImage(i,0,0,this.drawingCanvas.width,this.drawingCanvas.height),this.canvasTexture=new s.GOR(this.drawingCanvas),this.canvasTexture.anisotropy=this.renderer.capabilities.getMaxAnisotropy(),this.canvasTexture.generateMipmaps=!0,this.canvasTexture.magFilter=s.k6q,this.canvasTexture.minFilter=s.$_I,this.whiteboardMaterial.map=this.canvasTexture,this.whiteboardMaterial.needsUpdate=!0},this.drawingContext.lineWidth=8,this.drawingContext.lineJoin="round",this.drawingContext.lineCap="round",this.drawingContext.fontSmoothingEnabled=!0,this.drawingContext.fillStyle="white",this.drawingContext.fillRect(0,0,2048,1024),this.drawingCanvas.needsUpdate=!0,this.canvasTexture=new s.GOR(this.drawingCanvas),this.whiteboardMaterial.map=this.canvasTexture,this.whiteboardMaterial.map.needsUpdate=!0}throttle(e,t){let i;return(...s)=>{i||(i=setTimeout((()=>{e.apply(this,s),i=null}),t))}}update(){if(!this.isActive)return;this.raycaster.setFromCamera(this.mouse,this.camera.instance);const e=this.raycaster.intersectObjects(this.scene.children,!0);this.objectRaycasted=e.length>0?e[0]:null}draw(e,t){this.drawingContext.strokeStyle=this.drawColor,this.drawingContext.moveTo(this.drawStartPos.x,this.drawStartPos.y),this.drawingContext.lineTo(e,t),this.drawingContext.stroke(),this.drawStartPos.set(e,t),this.whiteboardMaterial.map.needsUpdate=!0}onMouseDown=()=>{this.objectRaycasted&&this.objectRaycasted.uv&&"whiteboardCanvas"==this.objectRaycasted.object.name&&(this.drawing=!0,this.drawStartPos.set(2048*this.objectRaycasted.uv.x,1024-1024*this.objectRaycasted.uv.y),this.drawingContext.beginPath())};onMouseMove=()=>{this.objectRaycasted&&this.objectRaycasted.object&&"whiteboardCanvas"==this.objectRaycasted.object.name?(this.experience.navigation.orbitControls.enableDamping=!1,this.experience.navigation.orbitControls.enabled=!1,this.webglElement.style.pointerEvents="none"):(this.experience.navigation.orbitControls.enableDamping=!0,this.experience.navigation.orbitControls.enabled=!0,this.webglElement.style.pointerEvents="auto"),this.drawing&&this.objectRaycasted&&this.objectRaycasted.uv&&"whiteboardCanvas"==this.objectRaycasted.object.name?this.draw(2048*this.objectRaycasted.uv.x,1024-1024*this.objectRaycasted.uv.y):this.drawing=!1};onMouseUp=()=>{this.drawing=!1,this.drawingContext.closePath()};activateControls(){window.addEventListener("pointerdown",this.onMouseDown,!1),window.addEventListener("pointermove",this.throttledMouseMove,!1),window.addEventListener("pointerup",this.onMouseUp,!1),this.onMouseMove(),this.isActive=!0}deactivateControls(){window.removeEventListener("pointerdown",this.onMouseDown,!1),window.removeEventListener("pointermove",this.throttledMouseMove,!1),window.removeEventListener("pointerup",this.onMouseUp,!1),this.isActive=!1}throttledMouseMove=this.throttle(this.onMouseMove,30);changeWhiteboardColor=e=>{const t={"black-marker":{color:"black",lineWidth:8},"red-marker":{color:"red",lineWidth:8},"green-marker":{color:"darkgreen",lineWidth:8},"blue-marker":{color:"blue",lineWidth:8},eraser:{color:"white",lineWidth:50}},{color:i,lineWidth:s}=t[e]||t["black-marker"];this.drawColor=i,this.drawingContext.lineWidth=s}}class ve{constructor(){this.experience=new Fe,this.scene=this.experience.scene,this.carpetGroup=new s.YJl,this.setCarpet()}setCarpet(){for(let e=0;e<32;++e){const t=new s.BKk({vertexShader:"#define GLSLIFY 1\nvarying vec2 vUv;\nvarying vec3 vNormal;\n\nuniform float uShellCount;\nuniform float uShellIndex;\nuniform float uShellLength;\n\nvoid main() {\n  float shellHeight = uShellIndex / uShellCount;\n  shellHeight = pow(shellHeight, 0.1);\n\n  vec3 vPosition = position;\n  vPosition += normal.xyz * uShellLength * shellHeight;\n  vUv = uv;\n  vNormal = normalize(mat3(normalMatrix) * normal);\n  float k = pow(shellHeight, 0.1);\n  vPosition +=  k * 0.1;\n  gl_Position = projectionMatrix * modelViewMatrix * vec4(vPosition, 1.0);\n}",fragmentShader:"#define GLSLIFY 1\nvarying vec2 vUv;\nuniform float uShellCount;\nuniform float uShellIndex;\nuniform float uDensity;\nuniform float uThickness;\nuniform vec3 uColor;\n\nfloat hash(uint n) {\n// Integer hash adapted for GLSL from Hugo Elias\n  n = (n << 13U) ^ n;\n  n = n * (n * n * 15731U + 0x789221U) + 0x13763125U;\n  n = (n << 13U) ^ n;\n  n = n * (n * n * 15731U + 0x789221U) + 0x89abcdefU;\n  return float(n & 0x7fffffffU) / float(0x7fffffff);\n}\n\nvoid main() {\n  vec2 newUV = vUv * uDensity;\n  vec2 localUV = fract(newUV) * 2.0 - 1.0;\n  float localDistanceFromCenter = length(localUV);\n  uvec2 tid = uvec2(uint(newUV.x), uint(newUV.y));\n  uint seed = tid.x + uint(100.0) * tid.y + uint(100.0) * uint(10.0);\n\n  float rand = hash(seed);\n\n  float h = uShellIndex / uShellCount;\n  bool outsideuThickness = localDistanceFromCenter > (uThickness * (rand - h));\n  float distanceToCenter = distance(vUv, vec2(0.5, 0.5));\n  if (outsideuThickness && uShellIndex > 0.0 || distanceToCenter > 0.5 || rand < h) {\n    discard;\n  }\n  else {\n    vec3 uColor = uColor * pow(max(h, 0.125), 0.5);\n    gl_FragColor = vec4(uColor, 1.0) ;\n  }\n}",side:s.$EB,uniforms:{uColor:{value:D.uColor},uShellCount:{value:D.uShellCount},uShellIndex:{value:e},uShellLength:{value:D.uShellLength},uDensity:{value:D.uDensity},uThickness:{value:D.uThickness}}}),i=new s.bdM(100,100),n=new s.eaF(i,t);n.rotation.copy(F),n.position.y=.1*e-10,n.receiveShadow=!0,n.castShadow=!0,this.carpetGroup.add(n)}this.carpetGroup.name="Carpet",this.carpetGroup.scale.copy(U),this.carpetGroup.position.copy(Y),this.scene.add(this.carpetGroup)}}class ye{constructor(){this.experience=new Fe,this.webglElement=this.experience.webglElement,this.renderer=this.experience.renderer.instance,this.cssArcadeMachineScene=this.experience.cssArcadeMachineScene,this.scene=this.experience.scene,this.resources=this.experience.resources,this.mouse=this.experience.mouse,this.screenSize=new s.I9Y(S,C),this.model={},this.arcadeMachineMaterial=this.experience.world.baked.model.material2,this.maxAnisotropy=this.renderer.capabilities.getMaxAnisotropy(),this.audioManager=this.experience.world.audioManager,this.setModel(),this.setArcadeScreen()}setModel=()=>{this.model.arcadeMachineModel=this.resources.items.arcadeMachine.scene,this.model.arcadeMachineModel.traverse((e=>{e.isMesh&&(e.material=this.arcadeMachineMaterial)})),this.model.arcadeMachineModel.name="arcadeMachine",this.scene.add(this.model.arcadeMachineModel)};setArcadeScreen=()=>{const e=document.createElement("div");e.style.width=this.screenSize.width+"px",e.style.height=this.screenSize.height+"px";const t=document.createElement("iframe");t.src="https://joan-arcade-machine.vercel.app",t.style.width=this.screenSize.width+"px",t.style.height=this.screenSize.height+"px",t.style.padding="16px",t.style.transparent=!0,t.id="arcade-screen",t.style.boxSizing="border-box",t.style.background="black",e.appendChild(t),t.addEventListener("load",(()=>{this.iframeWindow=t.contentWindow}));const i=new w.on(e);i.scale.copy(P),i.position.copy(L),i.rotateY(R),i.rotateX(E),this.cssArcadeMachineScene.add(i);const n=new s.BKk({blending:s.XIg,side:s.$EB,uniforms:{uCurvature:{value:A.uCurvature},uScreenResolution:{value:A.uScreenResolution},uScanLineOpacity:{value:A.uScanLineOpacity},uBaseColor:{value:A.uBaseColor},uColor:{value:A.uColor},uVignetteOpacity:{value:A.uVignetteOpacity},uBrightness:{value:A.uBrightness},uVignetteRoundness:{value:A.uVignetteOpacity}},vertexShader:"#define GLSLIFY 1\nvarying vec3 vPosition;\nvarying vec2 vUv;\nvoid main() {\n    vPosition = position;\n    vUv = uv;\n    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}",fragmentShader:"#define GLSLIFY 1\nvarying vec2 vUv;\nuniform vec2 uCurvature;\nuniform vec2 uScreenResolution;\nuniform vec2 uScanLineOpacity;\nuniform vec3 uBaseColor;\nuniform vec3 uColor;\nuniform float uVignetteOpacity;\nuniform float uBrightness;\nuniform float uVignetteRoundness;\nfloat PI = 3.1415926538;\n\nvec2 curveRemapUV(vec2 uv)\n{\n    // as we near the edge of our screen apply greater distortion using a sinusoid.\n    uv = uv * 2.0 - 1.0;\n    vec2 offset = abs(uv.yx) / vec2(uCurvature.x, uCurvature.y);\n    uv = uv + uv * offset * offset;\n    uv = uv * 0.5 + 0.5;\n    return uv;\n}\n\nvec4 scanLineIntensity(float uv, float resolution, float opacity)\n{\n    float intensity = sin(uv * resolution * PI * 2.0);\n    intensity = ((0.5 * intensity) + 0.5) * 0.9 + 0.1;\n    return vec4(vec3(pow(intensity, opacity)), 1.0);\n}\n\nvec4 vignetteIntensity(vec2 uv, vec2 resolution, float opacity, float roundness)\n{\n    float intensity = uv.x * uv.y * (1.0 - uv.x) * (1.0 - uv.y);\n    return vec4(vec3(clamp(pow((resolution.x / roundness) * intensity, opacity), 0.0, 1.0)), 1.0);\n}\n\nvoid main(void)\n{\n    vec2 remappedUV = curveRemapUV(vec2(vUv.x, vUv.y));\n    vec4 baseColor = vec4(uBaseColor, 0.00001);\n\n    baseColor *= vignetteIntensity(remappedUV, uScreenResolution, uVignetteOpacity, uVignetteRoundness);\n\n    baseColor *= scanLineIntensity(remappedUV.x, uScreenResolution.y, uScanLineOpacity.x);\n    baseColor *= scanLineIntensity(remappedUV.y, uScreenResolution.x, uScanLineOpacity.y);\n\n    baseColor *= vec4(vec3(uBrightness), 1.0);\n\n    if (remappedUV.x < 0.0 || remappedUV.y < 0.0 || remappedUV.x > 1.0 || remappedUV.y > 1.0){\n        gl_FragColor = vec4(uColor, 0.001);\n    } else {\n        gl_FragColor = baseColor;\n    }\n}"}),o=new s.bdM(this.screenSize.width,this.screenSize.height);this.model.screen=new s.eaF(o,n),this.model.screen.position.copy(i.position),this.model.screen.rotation.copy(i.rotation),this.model.screen.scale.copy(i.scale),this.model.screen.name="arcadeMachineScreen",this.model.arcadeMachineModel.add(this.model.screen)};handleKeyDownParent=e=>{this.iframeWindow.postMessage({type:"keyDownParent",key:e.key},"*")};handleKeyUpParent=e=>{this.iframeWindow.postMessage({type:"keyUpParent",key:e.key},"*")};onMouseMove=()=>{this.objectRaycasted&&this.objectRaycasted.object&&"arcadeMachine"==this.objectRaycasted.object.name?(this.experience.navigation.orbitControls.enableDamping=!1,this.experience.navigation.orbitControls.enabled=!1,this.webglElement.style.pointerEvents="none"):(this.experience.navigation.orbitControls.enableDamping=!0,this.experience.navigation.orbitControls.enabled=!0,this.webglElement.style.pointerEvents="auto")};activateControls=()=>{window.addEventListener("keydown",this.handleKeyDownParent),window.addEventListener("keyup",this.handleKeyUpParent),window.addEventListener("pointermove",this.onMouseMove),window.addEventListener("message",this.receiveMessage,!1),this.onMouseMove()};deactivateControls=()=>{window.removeEventListener("keydown",this.handleKeyDownParent),window.removeEventListener("keyup",this.handleKeyUpParent),window.removeEventListener("pointermove",this.onMouseMove),window.removeEventListener("message",this.receiveMessage,!1)};receiveMessage=e=>{"hit"==e.data?this.audioManager.playSingleAudio("hit",1):"tetris"==e.data?this.audioManager.playSingleAudio("tetris",1):"die"==e.data?this.audioManager.playSingleAudio("die",1):"select1"==e.data?this.audioManager.playSingleAudio("select1",1):"select2"==e.data&&this.audioManager.playSingleAudio("select2",1)}}class fe{constructor(){this.experience=new Fe,this.webglElement=this.experience.webglElement,this.cssLeftMonitor=this.experience.cssLeftMonitor,this.cssLeftMonitorScene=this.experience.cssLeftMonitorScene,this.resources=this.experience.resources,this.renderer=this.experience.renderer.instance,this.scene=this.experience.scene,this.raycaster=this.experience.raycaster,this.mouse=this.experience.mouse,this.navigation=this.experience.navigation,this.materialLeftMonitor=this.experience.world.baked.model.material2,this.isActive=!1,this.camera=this.experience.camera,this.audioManager=this.experience.world.audioManager,this.objectRaycasted=null,this.screenMonitorSize=new s.I9Y(_,W),this.model={},this.setModel(),this.setLeftMonitorScreen()}setModel(){this.model.mesh=this.resources.items.leftMonitor.scene,this.model.mesh.traverse((e=>{e.isMesh&&(e.material=this.materialLeftMonitor)})),this.model.mesh.name="leftMonitor",this.scene.add(this.model.mesh)}setLeftMonitorScreen(){const e=document.createElement("div");e.style.width=this.screenMonitorSize.width+"px",e.style.height=this.screenMonitorSize.height+"px";const t=document.createElement("iframe");t.src="https://joan-os.vercel.app",t.style.width=this.screenMonitorSize.width+"px",t.style.height=this.screenMonitorSize.height+"px",t.style.padding="8px",t.style.transparent=!0,t.id="left-monitor-screen",t.style.boxSizing="border-box",t.style.background="black",e.appendChild(t);const i=new w.on(e);i.position.copy(K),i.scale.copy(Z),this.cssLeftMonitorScene.add(i);const n=new s.G_z({color:"black",opacity:0,transparent:!0,blending:s.XIg}),o=new s.bdM(this.screenMonitorSize.width,this.screenMonitorSize.height),a=new s.eaF(o,n);a.position.copy(i.position),a.rotation.copy(i.rotation),a.scale.copy(i.scale),a.name="leftMonitorScreen",this.model.mesh.add(a)}activateControls(){window.addEventListener("pointermove",this.onMouseMove,!1),window.addEventListener("message",this.receiveMessage,!1),this.onMouseMove(),this.isActive=!0}deactivateControls(){window.removeEventListener("pointermove",this.onMouseMove,!1),window.removeEventListener("message",this.receiveMessage,!1),this.isActive=!1}receiveMessage=e=>{"Projects"==e.data?this.navigation.flyToPosition("rightMonitor"):"mousedown"==e.data?this.audioManager.playSingleAudio("mouseclick",1):"mouseup"==e.data&&this.audioManager.playSingleAudio("mouserelease",1)};onMouseMove=()=>{this.objectRaycasted&&this.objectRaycasted.object&&"leftMonitorScreen"==this.objectRaycasted.object.name?(this.experience.navigation.orbitControls.enableDamping=!1,this.experience.navigation.orbitControls.enabled=!1,this.webglElement.style.pointerEvents="none"):(this.experience.navigation.orbitControls.enableDamping=!0,this.experience.navigation.orbitControls.enabled=!0,this.webglElement.style.pointerEvents="auto")};update(){if(!this.isActive)return;this.raycaster.setFromCamera(this.mouse,this.camera.instance);const e=this.raycaster.intersectObjects(this.scene.children,!0);this.objectRaycasted=e.length>0?e[0]:null}}class xe{constructor(){this.experience=new Fe,this.webglElement=this.experience.webglElement,this.cssRightMonitorScene=this.experience.cssRightMonitorScene,this.resources=this.experience.resources,this.scene=this.experience.scene,this.renderer=this.experience.renderer.instance,this.camera=this.experience.camera,this.mouse=this.experience.mouse,this.materialRightMonitor=this.experience.world.baked.model.material2,this.raycaster=this.experience.raycaster,this.screenMonitorSize=new s.I9Y(_,W),this.model={},this.audioManager=this.experience.world.audioManager,this.setModel(),this.setRightMonitorScreen()}setModel(){this.model.mesh=this.resources.items.rightMonitor.scene,this.model.mesh.traverse((e=>{e.isMesh&&(e.material=this.materialRightMonitor)})),this.model.mesh.name="rightMonitor",this.scene.add(this.model.mesh)}setRightMonitorScreen(){const e=document.createElement("div");e.style.width=this.screenMonitorSize.width+"px",e.style.height=this.screenMonitorSize.height+"px";const t=document.createElement("iframe");t.src="https://joan-art-gallery.vercel.app",t.style.width=this.screenMonitorSize.width+"px",t.style.height=this.screenMonitorSize.height+"px",t.style.padding="8px",t.style.transparent=!0,t.id="right-monitor-screen",t.style.boxSizing="border-box",t.style.background="black",e.appendChild(t);const i=new w.on(e);i.position.copy(Q),i.scale.copy(J),i.rotation.y=ee,this.cssRightMonitorScene.add(i);const n=new s.V9B({color:"black",side:s.$EB,opacity:0,transparent:!0,blending:s.XIg}),o=new s.bdM(this.screenMonitorSize.width,this.screenMonitorSize.height),a=new s.eaF(o,n);a.position.copy(i.position),a.rotation.copy(i.rotation),a.scale.copy(i.scale),a.name="rightMonitorScreen",this.model.mesh.add(a)}activateControls(){window.addEventListener("pointermove",this.onMouseMove,!1),window.addEventListener("message",this.receiveMessage,!1),this.onMouseMove(),this.isActive=!0}deactivateControls(){window.removeEventListener("pointermove",this.onMouseMove,!1),window.removeEventListener("message",this.receiveMessage,!1),this.isActive=!1}receiveMessage=e=>{"footstep01"==e.data?this.audioManager.playSingleAudio("footstep01",.3):"footstep02"==e.data?this.audioManager.playSingleAudio("footstep02",.3):"footstep03"==e.data?this.audioManager.playSingleAudio("footstep03",.3):"vase"==e.data?this.audioManager.playSingleAudio("vase_break",.3):"door"==e.data?this.audioManager.playSingleAudio("door",1):"trophy"==e.data?this.audioManager.playSingleAudio("trophy",7):"trophy_platinum"==e.data?this.audioManager.playSingleAudio("trophy_platinum",.5):"start"==e.data&&this.audioManager.playSingleAudio("start",.3)};onMouseMove=()=>{this.objectRaycasted&&this.objectRaycasted.object&&"rightMonitorScreen"==this.objectRaycasted.object.name?(this.experience.navigation.orbitControls.enableDamping=!1,this.experience.navigation.orbitControls.enabled=!1,this.webglElement.style.pointerEvents="none"):(this.experience.navigation.orbitControls.enabled=!0,this.experience.navigation.orbitControls.enableDamping=!0,this.webglElement.style.pointerEvents="auto")};update(){if(!this.isActive)return;this.raycaster.setFromCamera(this.mouse,this.camera.instance);const e=this.raycaster.intersectObjects(this.scene.children,!0);this.objectRaycasted=e.length>0?e[0]:null}}const Me=JSON.parse('{"0":{"row":2,"col":2,"depth":2,"colors":{"F":null,"B":null,"L":null,"R":null,"U":null,"D":null}},"1":{"row":3,"col":3,"depth":3,"colors":{"F":null,"B":"R","L":null,"R":"G","U":null,"D":"Y"}},"2":{"row":3,"col":3,"depth":2,"colors":{"F":null,"B":null,"L":null,"R":"G","U":null,"D":"Y"}},"3":{"row":3,"col":3,"depth":1,"colors":{"F":"O","B":null,"L":null,"R":"G","U":null,"D":"Y"}},"4":{"row":2,"col":3,"depth":1,"colors":{"F":"O","B":null,"L":null,"R":"G","U":null,"D":null}},"5":{"row":2,"col":3,"depth":2,"colors":{"F":null,"B":null,"L":null,"R":"G","U":null,"D":null}},"6":{"row":2,"col":3,"depth":3,"colors":{"F":null,"B":"R","L":null,"R":"G","U":null,"D":null}},"7":{"row":1,"col":3,"depth":3,"colors":{"F":null,"B":"R","L":null,"R":"G","U":"W","D":null}},"8":{"row":1,"col":3,"depth":2,"colors":{"F":null,"B":null,"L":null,"R":"G","U":"W","D":null}},"9":{"row":1,"col":3,"depth":1,"colors":{"F":"O","B":null,"L":null,"R":"G","U":"W","D":null}},"10":{"row":1,"col":2,"depth":1,"colors":{"F":"O","B":null,"L":null,"R":null,"U":"W","D":null}},"11":{"row":2,"col":2,"depth":1,"colors":{"F":"O","B":null,"L":null,"R":null,"U":null,"D":null}},"12":{"row":3,"col":2,"depth":1,"colors":{"F":"O","B":null,"L":null,"R":null,"U":null,"D":"Y"}},"13":{"row":3,"col":1,"depth":1,"colors":{"F":"O","B":null,"L":"B","R":null,"U":null,"D":"Y"}},"14":{"row":2,"col":1,"depth":1,"colors":{"F":"O","B":null,"L":"B","R":null,"U":null,"D":null}},"15":{"row":1,"col":1,"depth":1,"colors":{"F":"O","B":null,"L":"B","R":null,"U":"W","D":null}},"16":{"row":1,"col":1,"depth":2,"colors":{"F":null,"B":null,"L":"B","R":null,"U":"W","D":null}},"17":{"row":1,"col":1,"depth":3,"colors":{"F":null,"B":"R","L":"B","R":null,"U":"W","D":null}},"18":{"row":2,"col":1,"depth":3,"colors":{"F":null,"B":"R","L":"B","R":null,"U":null,"D":null}},"19":{"row":2,"col":1,"depth":2,"colors":{"F":null,"B":null,"L":"B","R":null,"U":null,"D":null}},"20":{"row":3,"col":1,"depth":2,"colors":{"F":null,"B":null,"L":"B","R":null,"U":null,"D":"Y"}},"21":{"row":3,"col":1,"depth":3,"colors":{"F":null,"B":"R","L":"B","R":null,"U":null,"D":"Y"}},"22":{"row":1,"col":2,"depth":3,"colors":{"F":null,"B":"R","L":null,"R":null,"U":"W","D":null}},"23":{"row":2,"col":2,"depth":3,"colors":{"F":null,"B":"R","L":null,"R":null,"U":null,"D":null}},"24":{"row":3,"col":2,"depth":3,"colors":{"F":null,"B":"R","L":null,"R":null,"U":null,"D":"Y"}},"25":{"row":1,"col":2,"depth":2,"colors":{"F":null,"B":null,"L":null,"R":null,"U":"W","D":null}},"26":{"row":3,"col":2,"depth":2,"colors":{"F":null,"B":null,"L":null,"R":null,"U":null,"D":"Y"}}}');const ke=class{constructor(e,t){this.experience=new Fe,this.position=this.originalPos=e,this.scale=this.originalScale=t,this.scene=this.experience.scene,this.camera=this.experience.camera.instance,this.resources=this.experience.resources,this.rubikGroup=new s.YJl,this.rubikCubes=[],this.childrensToRotate=[],this.sideToRotate,this.layerToRotate,this.movesCompletedStack=[],this.currentMove,this.movementsStack=[],this.pivot=new s.B69,this.objectRaycasted,this.firstClickPosition,this.firstClickNormal,this.dragging=!1,this.objectClicked,this.isMoving=!1,this.allCubies=[],this.isActive=!1,this.pointer=new s.I9Y,this.duration=0,this.isPlaced=!0,this.raycaster=this.experience.raycaster,this.audioManager=this.experience.world.audioManager,this.setRubiksCube()}setRubiksCube(){const e=this.resources.items.rubiksCube.scene;e.traverse((e=>{e.isMesh&&(e.material.envMap=this.resources.items.cubeTexture)}));for(let t=e.children.length-1;t>=0;t--){const i=e.children[t],s=Me[t];Object.assign(i,s),i.isRubik=!0,i.position.copy(this.position),this.rubikCubes.push(i),this.rubikGroup.add(i)}this.rubikGroup.name="rubikGroup",this.scene.add(this.rubikGroup),this.movementsStack.push({layer:"col",number:1,orientation:1},{layer:"row",number:3,orientation:-1},{layer:"depth",number:3,orientation:1},{layer:"col",number:1,orientation:-1}),this.startNextMove(),this.hasBeenSolved=!1,this.rubikGroup.position.set(this.position.x,this.position.y,this.position.z),this.rubikGroup.scale.set(this.scale,this.scale,this.scale),this.rubikGroup.rotation.y=le;const t=new s.$p8(16777215,1),i=new s.ZyN(16777215,1);i.position.y=40,i.position.z=40,i.position.x=40,this.scene.add(t),this.scene.add(i)}activateControls(){this.duration=.5,window.addEventListener("pointermove",this.onPointerMove),window.addEventListener("pointerdown",this.onPointerDown),window.addEventListener("pointerup",this.onPointerUp),this.isActive=!0}deactivateControls(){this.duration=0,window.removeEventListener("pointermove",this.onPointerMove),window.removeEventListener("pointerdown",this.onPointerDown),window.removeEventListener("pointerup",this.onPointerUp),this.isActive=!1}reubicateCube(){this.isPlaced=!1,this.rubikGroup.traverse((e=>{e.isMesh&&(e.renderOrder=999,e.material.transparent=!0,e.material.depthTest=!1)})),this.rubikGroup.children.forEach((e=>{u.os.to(e.position,{x:0,y:0,z:0,duration:1,ease:"sine.out"})})),u.os.to(this.rubikGroup.scale,{x:1,y:1,z:1,duration:1,ease:"sine.out"}),u.os.to(this.rubikGroup.position,{x:0,y:0,z:0,duration:1,ease:"sine.out"}),u.os.to(this.rubikGroup.rotation,{x:0,y:0,z:0,duration:1,ease:"sine.out",onComplete:()=>{this.isActive=!0}}),this.position=new s.Pq0(0,0,0)}resetOriginalConfig(){this.rubikGroup.children.forEach((e=>{u.os.to(e.position,{x:this.originalPos.x,y:this.originalPos.y,z:this.originalPos.z,duration:1,ease:"sine.out",onComplete:()=>{this.isPlaced=!0,this.rubikGroup.traverse((e=>{e.isMesh&&(e.renderOrder=0,e.material.transparent=!1,e.material.depthTest=!0)}))}})})),u.os.to(this.rubikGroup.scale,{x:this.originalScale,y:this.originalScale,z:this.originalScale,duration:1,ease:"sine.out"}),u.os.to(this.rubikGroup.position,{x:this.originalPos.x,y:this.originalPos.y,z:this.originalPos.z,duration:1,ease:"sine.out"}),u.os.to(this.rubikGroup.rotation,{x:Math.PI,y:-.48024479697875944,z:Math.PI,duration:1,ease:"sine.out"}),this.position=new s.Pq0(this.originalPos.x,this.originalPos.y,this.originalPos.z)}winAnimation(){this.rubikGroup.children.forEach((e=>{u.os.to(e.position,{x:this.originalPos.x,y:this.originalPos.y,z:this.originalPos.z,duration:2,ease:"elastic.in",onComplete:()=>{this.isPlaced=!0,this.rubikGroup.traverse((e=>{e.isMesh&&(e.renderOrder=0,e.material.transparent=!1,e.material.depthTest=!0)}))}})})),u.os.to(this.rubikGroup.scale,{x:this.originalScale,y:this.originalScale,z:this.originalScale,duration:2,ease:"circ.out"}),u.os.to(this.rubikGroup.position,{x:this.originalPos.x,y:this.originalPos.y,z:this.originalPos.z,duration:2,ease:"back.in"}),u.os.to(this.rubikGroup.rotation,{x:3*Math.PI,y:6*Math.PI-.48024479697875944,z:3*Math.PI,duration:2.2,ease:"back.in",onComplete:()=>{this.rubikGroup.rotation.x=Math.PI,this.rubikGroup.rotation.y=-.48024479697875944,this.rubikGroup.rotation.z=Math.PI,this.experience.world.confetti.explode()}}),this.position=new s.Pq0(this.originalPos.x,this.originalPos.y,this.originalPos.z)}onPointerMove=e=>{this.pointer.x=e.clientX/window.innerWidth*2-1,this.pointer.y=-e.clientY/window.innerHeight*2+1};onPointerDown=()=>{if(this.objectRaycasted&&this.objectRaycasted.object.parent.isRubik&&!this.isMoving){const e=this.objectRaycasted.face.normal;this.firstClickNormal=this.getRealNormal(e.transformDirection(this.objectRaycasted.object.parent.matrixWorld)),this.objectClicked=this.objectRaycasted.object.parent,this.draggingg=!0,this.firstClickPosition=new s.I9Y(this.pointer.x,this.pointer.y)}};onPointerUp=()=>{if(this.draggingg){const e=new s.I9Y(this.pointer.x,this.pointer.y),t=new s.I9Y(e.x-this.firstClickPosition.x,e.y-this.firstClickPosition.y);if(0==t.x&&0==t.y)return;const i=Math.abs(t.x)<=Math.abs(t.y),n=t.x>=0,o=t.y>=0,a="x"===this.firstClickNormal.layer,r="y"===this.firstClickNormal.layer,c="z"===this.firstClickNormal.layer;i?a?this.movementsStack.push({layer:"depth",number:this.objectClicked.depth,orientation:0===this.firstClickNormal.sign?o?0:1:o?1:0}):(r||c)&&this.movementsStack.push({layer:"col",number:this.objectClicked.col,orientation:0===this.firstClickNormal.sign?o?1:0:o?0:1}):a?this.movementsStack.push({layer:"row",number:this.objectClicked.row,orientation:(this.firstClickNormal.sign,n?1:0)}):r?this.movementsStack.push({layer:"depth",number:this.objectClicked.depth,orientation:0===this.firstClickNormal.sign?n?1:0:n?0:1}):c&&this.movementsStack.push({layer:"row",number:this.objectClicked.row,orientation:(this.firstClickNormal.sign,n?1:0)}),this.startNextMove(),this.draggingg=!1,this.objectClicked=null}};getRealNormal(e){return Math.abs(e.x)>Math.abs(e.y)?Math.abs(e.z)>Math.abs(e.x)?{layer:"z",sign:e.z>=0?1:0}:{layer:"x",sign:e.x>=0?1:0}:Math.abs(e.z)>Math.abs(e.y)?{layer:"z",sign:e.z>=0?1:0}:{layer:"y",sign:e.y>=0?1:0}}moveComplete(){this.isMoving=!1,this.pivot.updateMatrixWorld(),this.scene.remove(this.pivot.children);const e=-1==this.sideToRotate?0:1,t="x"===this.layerToRotate?"col":"y"===this.layerToRotate?"row":"z"===this.layerToRotate?"depth":void 0;this.childrensToRotate.forEach((i=>{i.updateMatrixWorld(),i.rubikPosition=i.position.clone(),i.rubikPosition.applyMatrix4(this.pivot.matrixWorld),this.scene.attach(i),this.updateValuesAfterRotation(t,i,e),this.rubikGroup.add(i)})),this.movesCompletedStack.push(this.currentMove),this.startNextMove(),this.allCubies.length=0,this.checkAllCubies(this.scene),this.allCubies.sort(((e,t)=>e.name.localeCompare(t.name))),this.checkIfCubeIsSolved(this.allCubies)}checkIfCubeIsSolved(e){let t=!0;const i={U:null,D:null,L:null,R:null,F:null,B:null};e.forEach((e=>{if(1==e.depth)if(null==i.F)i.F=e.colors.F;else if(i.F!==e.colors.F)return void(t=!1);if(3==e.depth)if(null==i.B)i.B=e.colors.B;else if(i.B!==e.colors.B)return void(t=!1);if(1==e.row)if(null==i.U)i.U=e.colors.U;else if(i.U!==e.colors.U)return void(t=!1);if(3==e.row)if(null==i.D)i.D=e.colors.D;else if(i.D!==e.colors.D)return void(t=!1);if(1==e.col)if(null==i.L)i.L=e.colors.L;else if(i.L!==e.colors.L)return void(t=!1);if(3==e.col)if(null==i.R)i.R=e.colors.R;else if(i.R!==e.colors.R)return void(t=!1)})),t&&!this.hasBeenSolved&&(this.experience.navigation.rubikWon(),this.winAnimation(),this.hasBeenSolved=!0)}checkAllCubies(e){e.hasOwnProperty("colors")&&this.allCubies.push(e),e.children&&e.children.forEach((e=>{this.checkAllCubies(e)}))}rotateValues(e,t){let i,s;return s=1==e?3:3==e?1:e,i=t,{newValue1:i,newValue2:s}}updateColors(e,t){const i={...e};return t.forEach(((s,n)=>{const o=t[(n+1)%t.length];e[o]=i[s]})),e}updateValuesAfterRotation(e,t,i){let s;switch(e){case"row":1===i?(s=this.rotateValues(t.depth,t.col),t.depth=s.newValue1,t.col=s.newValue2,t.colors=this.updateColors(t.colors,["F","R","B","L"])):(s=this.rotateValues(t.col,t.depth),t.col=s.newValue1,t.depth=s.newValue2,t.colors=this.updateColors(t.colors,["F","L","B","R"]));break;case"col":1===i?(s=this.rotateValues(t.depth,t.row),t.depth=s.newValue1,t.row=s.newValue2,t.colors=this.updateColors(t.colors,["F","D","B","U"])):(s=this.rotateValues(t.row,t.depth),t.row=s.newValue1,t.depth=s.newValue2,t.colors=this.updateColors(t.colors,["F","U","B","D"]));break;case"depth":1===i?(s=this.rotateValues(t.col,t.row),t.col=s.newValue1,t.row=s.newValue2,t.colors=this.updateColors(t.colors,["R","U","L","D"])):(s=this.rotateValues(t.row,t.col),t.row=s.newValue1,t.col=s.newValue2,t.colors=this.updateColors(t.colors,["R","D","L","U"]))}t.updateWorldMatrix()}rotateCube(e,t,i){this.childrensToRotate=[],this.rubikCubes.forEach((i=>{"row"===e?i.row===t&&this.childrensToRotate.push(i):"col"===e?i.col===t&&this.childrensToRotate.push(i):"depth"===e&&i.depth===t&&this.childrensToRotate.push(i)})),this.childrensToRotate.forEach((t=>{this.sideToRotate=i?1:-1,"row"===e?this.layerToRotate="y":"col"===e?this.layerToRotate="x":"depth"===e&&(this.layerToRotate="z")}))}startNextMove(){if(this.movementsStack.length){if(0!=this.duration){const e=Math.floor(3*Math.random())+1;this.audioManager.playSingleAudio("rubik_"+e,.5)}if(!this.isMoving){this.currentMove=this.movementsStack.shift(),this.rotateCube(this.currentMove.layer,this.currentMove.number,this.currentMove.orientation),this.pivot.position.set(this.position.x,this.position.y,this.position.z),this.pivot.rotation.set(0,0,0),this.pivot.updateMatrixWorld(),this.pivot.name="rubikPivot",this.scene.add(this.pivot),this.childrensToRotate.forEach((e=>{this.pivot.attach(e)})),this.isMoving=!0;const e=this.pivot.rotation[this.layerToRotate]+this.sideToRotate*Math.PI/2,t="power1.inOut";u.os.to(this.pivot.rotation,{[this.layerToRotate]:e,duration:this.duration,ease:t,onComplete:()=>{this.moveComplete()}})}}}update(){if(!this.isActive)return;this.raycaster.setFromCamera(this.pointer,this.camera);const e=this.raycaster.intersectObjects(this.scene.children,!0);e.length?this.objectRaycasted=e[0]:this.objectRaycasted=null}};class Se{constructor(){this.experience=new Fe,this.resources=this.experience.resources,this.scene=this.experience.scene,this.camera=this.experience.camera,this.drawStartPos=new s.I9Y(-1,-1),this.drawColor="black",this.offset=new s.Pq0(.765921,-.121864,-1.42433),this.vertices=[new s.Pq0(4.275921,5.3,.8),new s.Pq0(4.275921,1.8,-2.1)],this.limitationPlane=[],this.setSkybox()}setSkybox(){this.planeSkybox=new s.Zcv(new s.Pq0(-1,0,0),7),this.vertices.forEach((e=>{this.intersectLinePlane(this.camera.instance.position,e)}));const e=new s.bdM(320,200),t=this.resources.items.skyTexture;t.colorSpace=s.er$,t.wrapS=s.kTW,t.wrapT=s.kTW,this.planeMat=new s.BKk({uniforms:{uSkyTexture:{value:t},uMinY:{value:this.limitationPlane[1].x},uMaxY:{value:this.limitationPlane[0].x},uMinZ:{value:this.limitationPlane[1].y},uMaxZ:{value:this.limitationPlane[0].y}},vertexShader:"#define GLSLIFY 1\nvarying vec3 vPosition;\nvarying vec2 vUv;\nvoid main() {\n    vPosition = position;\n    vUv = uv;\n    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}",fragmentShader:"#define GLSLIFY 1\nuniform float uMinY;\nuniform float uMaxY;\nuniform float uMinZ;\nuniform float uMaxZ;\nuniform sampler2D uSkyTexture;\nvarying vec3 vPosition;\nvarying vec2 vUv;\n\nvec2 scaleUV(vec2 uv, float scale) {\n    float center = 0.5;\n    return ((uv - center) * scale) + center;\n}\n\nvoid main() {\n    vec2 offsetUV = vec2(vUv.x + 0.025, vUv.y - 0.0015);\n\n    vec3 skyTexture = texture2D(uSkyTexture, scaleUV(offsetUV, 15.0)).rgb;\n    if (\n    vPosition.y >= uMinY && vPosition.y <= uMaxY &&\n    vPosition.x >= uMinZ && vPosition.x <= uMaxZ\n    ) {\n        gl_FragColor = vec4(skyTexture, 1.0);\n    } else {\n        discard;\n    }\n}"});const i=new s.eaF(e,this.planeMat);i.rotateY(-Math.PI/2),i.position.x=7,this.scene.add(i)}intersectLinePlane(e,t){const i=(new s.Pq0).subVectors(t,e),n=this.planeSkybox.normal,o=this.planeSkybox.constant,a=-(n.dot(e)+o)/n.dot(i),r=(new s.Pq0).copy(e).add(i.multiplyScalar(a));this.limitationPlane.push(new s.I9Y(r.y,r.z))}update(){this.planeMat&&(this.limitationPlane=[],this.vertices.forEach((e=>{this.intersectLinePlane(this.camera.instance.position,e)})),this.planeMat.uniforms.uMinY.value=this.limitationPlane[1].x,this.planeMat.uniforms.uMinZ.value=this.limitationPlane[1].y,this.planeMat.uniforms.uMaxY.value=this.limitationPlane[0].x,this.planeMat.uniforms.uMaxZ.value=this.limitationPlane[0].y)}}class Ce{constructor(){this.experience=new Fe,this.scene=this.experience.scene,this.infoParticles=[],this.dummy=new s.B69,this.hasExploded=!1,this.audioManager=this.experience.world.audioManager,this.setConfetti()}setConfetti(){this.geometry=new s.bdM(.05,.05),this.material=new s.V9B({color:16777215,side:s.$EB}),this.particles=new s.ZLX(this.geometry,this.material,q),this.particles.visible=!1,this.scene.add(this.particles)}randomFromTo(e,t){return Math.floor(Math.random()*(t-e+1)+e)}randomPlusMinus(e){return Math.random()<.5?-Math.random()*e:Math.random()*e}getRandomColor(){var e=Math.floor(Math.random()*N.length);return N[e]}explode(){this.audioManager.playSingleAudio("confetti",.5),this.audioManager.playSingleAudio("partyblower",.3),this.particles.visible=!0,this.hasExploded=!0,setTimeout((()=>{this.destroy()}),2e3);for(var e=0;e<q;e++){const t={},i={};i.x=600*(Math.random()-.5)*Math.random(),i.y=600*(Math.random()-.5)*Math.random(),i.z=600*(Math.random()-.5)*Math.random(),t.destination=i;const n={};n.x=this.randomPlusMinus(.4),n.y=this.randomPlusMinus(.4),n.z=this.randomPlusMinus(.4),t.rotateSpeed=n,this.infoParticles.push(t),this.particles.setColorAt(e,new s.Q1f(this.getRandomColor()))}const t=new s.B69;for(e=0;e<q;e++){t.position.y=7.5,t.rotation.x=Math.random()*Math.PI*2,t.rotation.y=Math.random()*Math.PI*2,t.rotation.z=Math.random()*Math.PI*2;const i=this.randomFromTo(2,5);t.scale.x=i,t.scale.y=i,t.updateMatrix(),this.particles.setMatrixAt(e,t.matrix)}}update=()=>{if(!this.hasExploded)return;const{particles:e,infoParticles:t,dummy:i}=this;for(let n=0;n<q;n++){const{destination:o,rotateSpeed:a}=t[n];o.y-=this.randomFromTo(3,6);const r=new s.kn4;e.getMatrixAt(n,r);const c=(new s.Pq0).setFromMatrixPosition(r),h=(new s.O9p).setFromRotationMatrix(r),l=(o.x-c.x)/8e3,d=(o.y-c.y)/1e4,u=(o.z-c.z)/8e3;i.position.copy(c.add(new s.Pq0(l,d,u))),i.rotation.set(h.x+a.x,h.y+a.y,h.z+a.z),i.updateMatrix(),e.setMatrixAt(n,i.matrix)}e.instanceMatrix.needsUpdate=!0};destroy=()=>{this.particles.material.dispose(),this.particles.geometry.dispose(),this.scene.remove(this.particles),this.particles=null,this.hasExploded=!1}}class Pe{constructor(){this.experience=new Fe,this.resources=this.experience.resources,this.scene=this.experience.scene,this.camera=this.experience.camera.instance,this.audioButton=document.querySelector(".audio-button"),this.isMuted=!1,this.hasStarted=!1,this.activeSounds=[],this.listener=new s.Pf$,this.camera.add(this.listener),this.setAudioManager()}setAudioManager(){this.audioButton.addEventListener("click",(()=>{this.audioButton.classList.contains("audio-button-muted")?(this.isMuted=!1,this.unmuteAudios(),this.audioButton.classList.remove("audio-button-muted")):(this.isMuted=!0,this.muteAudios(),this.audioButton.classList.add("audio-button-muted"))}))}muteAudios(){this.activeSounds.forEach((e=>{e.sound.setVolume(0)}))}unmuteAudios(){this.activeSounds.forEach((e=>{e.sound.setVolume(e.volume)}))}playSingleAudio(e,t){if(this.isMuted)return;const i=this.resources.items[e];if(!i)return;const n=new s.fP5(this.listener);n.setBuffer(i),n.setLoop(!1),n.setVolume(t),n.play();const o={sound:n,volume:t};this.activeSounds.push(o),n.source.onended=()=>{this.removeSound(o)}}playLoopAudio(e,t){const i=this.resources.items[e];if(!i)return;const n=new s.fP5(this.listener);n.setBuffer(i),n.setLoop(!0),n.setVolume(this.isMuted?0:t),n.play();const o={sound:n,volume:t};this.activeSounds.push(o)}removeSound(e){const t=this.activeSounds.indexOf(e);-1!==t&&this.activeSounds.splice(t,1),e.sound&&e.sound.disconnect()}stopAllSounds(){this.activeSounds.forEach((e=>{e.sound.isPlaying&&e.sound.stop(),e.sound.disconnect()})),this.activeSounds=[]}destroy(){this.stopAllSounds(),this.camera.remove(this.listener)}}class Le{constructor(e){this.experience=new Fe,this.config=this.experience.config,this.scene=this.experience.scene,this.resources=this.experience.resources,this.resources.on("groupEnd",(e=>{"base"===e.name&&(this.setAudioManager(),this.setBaked(),this.setWhiteboard(),this.setCarpet(),this.setArcadeScreen(),this.setLeftMonitorScreen(),this.setRightMonitorScreen(),this.setTopChair(),this.setSkybox(),this.setConfetti(),this.setCoffeeSteam(),this.setRubiksCube())}))}setBaked(){this.baked=new me}setRubiksCube(){this.rubiksCube=new ke(de,.021432)}setSkybox(){this.skybox=new Se}setCoffeeSteam(){this.coffeeSteam=new ge}setTopChair(){this.topChair=new be}setConfetti(){this.confetti=new Ce}setWhiteboard(){this.whiteboard=new we}setCarpet(){this.carpet=new ve}setArcadeScreen(){this.arcadeScreen=new ye}setLeftMonitorScreen(){this.leftMonitorScreen=new fe}setRightMonitorScreen(){this.rightMonitorScreen=new xe}setAudioManager(){this.audioManager=new Pe}resize(){}update(){this.coffeeSteam&&this.coffeeSteam.update(),this.topChair&&this.topChair.update(),this.rubiksCube&&this.rubiksCube.update(),this.skybox&&this.skybox.update(),this.leftMonitorScreen&&this.leftMonitorScreen.update(),this.rightMonitorScreen&&this.rightMonitorScreen.update(),this.confetti&&this.confetti.update(),this.whiteboard&&this.whiteboard.update()}destroy(){}}const Ee=new s.Pq0(-4,0,-4),Re=new s.Pq0(4,4,4),Ae={type:"change"},Te={type:"start"},ze={type:"end"},je=new s.RlV,Ie=new s.Zcv,Be=Math.cos(70*s.cj9.DEG2RAD);class Oe extends s.Qev{constructor(e,t){super(),this.object=e,this.domElement=t,this.domElement.style.touchAction="none",this.enabled=!0,this.target=new s.Pq0,this.cursor=new s.Pq0,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minTargetRadius=0,this.maxTargetRadius=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.zoomToCursor=!1,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:s.kBv.ROTATE,MIDDLE:s.kBv.DOLLY,RIGHT:s.kBv.PAN},this.touches={ONE:s.wtR.ROTATE,TWO:s.wtR.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this.getPolarAngle=function(){return r.phi},this.getAzimuthalAngle=function(){return r.theta},this.getDistance=function(){return this.object.position.distanceTo(this.target)},this.listenToKeyEvents=function(e){e.addEventListener("keydown",X),this._domElementKeyEvents=e},this.stopListenToKeyEvents=function(){this._domElementKeyEvents.removeEventListener("keydown",X),this._domElementKeyEvents=null},this.saveState=function(){i.target0.copy(i.target),i.position0.copy(i.object.position),i.zoom0=i.object.zoom},this.reset=function(){i.target.copy(i.target0),i.object.position.copy(i.position0),i.object.zoom=i.zoom0,i.object.updateProjectionMatrix(),i.dispatchEvent(Ae),i.update(),o=n.NONE},this.update=function(){const t=new s.Pq0,d=(new s.PTz).setFromUnitVectors(e.up,new s.Pq0(0,1,0)),u=d.clone().invert(),p=new s.Pq0,m=new s.PTz,g=new s.Pq0,b=2*Math.PI;return function(w=null){const v=i.object.position;t.copy(v).sub(i.target),t.applyQuaternion(d),r.setFromVector3(t),i.autoRotate&&o===n.NONE&&L(function(e){return null!==e?2*Math.PI/60*i.autoRotateSpeed*e:2*Math.PI/60/60*i.autoRotateSpeed}(w)),i.enableDamping?(r.theta+=c.theta*i.dampingFactor,r.phi+=c.phi*i.dampingFactor):(r.theta+=c.theta,r.phi+=c.phi);let y=i.minAzimuthAngle,k=i.maxAzimuthAngle;isFinite(y)&&isFinite(k)&&(y<-Math.PI?y+=b:y>Math.PI&&(y-=b),k<-Math.PI?k+=b:k>Math.PI&&(k-=b),r.theta=y<=k?Math.max(y,Math.min(k,r.theta)):r.theta>(y+k)/2?Math.max(y,r.theta):Math.min(k,r.theta)),r.phi=Math.max(i.minPolarAngle,Math.min(i.maxPolarAngle,r.phi)),r.makeSafe(),!0===i.enableDamping?i.target.addScaledVector(l,i.dampingFactor):i.target.add(l),i.target.clamp(Ee,Re),i.target.sub(i.cursor),i.target.clampLength(i.minTargetRadius,i.maxTargetRadius),i.target.add(i.cursor),i.zoomToCursor&&M||i.object.isOrthographicCamera?r.radius=B(r.radius):r.radius=B(r.radius*h),t.setFromSpherical(r),t.applyQuaternion(u),v.copy(i.target).add(t),i.object.lookAt(i.target),!0===i.enableDamping?(c.theta*=1-i.dampingFactor,c.phi*=1-i.dampingFactor,l.multiplyScalar(1-i.dampingFactor)):(c.set(0,0,0),l.set(0,0,0));let S=!1;if(i.zoomToCursor&&M){let n=null;if(i.object.isPerspectiveCamera){const e=t.length();n=B(e*h);const s=e-n;i.object.position.addScaledVector(f,s),i.object.updateMatrixWorld()}else if(i.object.isOrthographicCamera){const e=new s.Pq0(x.x,x.y,0);e.unproject(i.object),i.object.zoom=Math.max(i.minZoom,Math.min(i.maxZoom,i.object.zoom/h)),i.object.updateProjectionMatrix(),S=!0;const o=new s.Pq0(x.x,x.y,0);o.unproject(i.object),i.object.position.sub(o).add(e),i.object.updateMatrixWorld(),n=t.length()}else i.zoomToCursor=!1;null!==n&&(this.screenSpacePanning?i.target.set(0,0,-1).transformDirection(i.object.matrix).multiplyScalar(n).add(i.object.position):(je.origin.copy(i.object.position),je.direction.set(0,0,-1).transformDirection(i.object.matrix),Math.abs(i.object.up.dot(je.direction))<Be?e.lookAt(i.target):(Ie.setFromNormalAndCoplanarPoint(i.object.up,i.target),je.intersectPlane(Ie,i.target))))}else i.object.isOrthographicCamera&&(S=1!==h,S&&(i.object.zoom=Math.max(i.minZoom,Math.min(i.maxZoom,i.object.zoom/h)),i.object.updateProjectionMatrix()));return h=1,M=!1,!!(S||p.distanceToSquared(i.object.position)>a||8*(1-m.dot(i.object.quaternion))>a||g.distanceToSquared(i.target)>a)&&(i.dispatchEvent(Ae),p.copy(i.object.position),m.copy(i.object.quaternion),g.copy(i.target),!0)}}(),this.dispose=function(){i.domElement.removeEventListener("contextmenu",Q),i.domElement.removeEventListener("pointerdown",N),i.domElement.removeEventListener("pointercancel",W),i.domElement.removeEventListener("wheel",K),i.domElement.removeEventListener("pointermove",_),i.domElement.removeEventListener("pointerup",W);i.domElement.getRootNode().removeEventListener("keydown",Z,{capture:!0}),null!==i._domElementKeyEvents&&(i._domElementKeyEvents.removeEventListener("keydown",X),i._domElementKeyEvents=null)};const i=this,n={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let o=n.NONE;const a=1e-6,r=new s.YHV,c=new s.YHV;let h=1;const l=new s.Pq0,d=new s.I9Y,u=new s.I9Y,p=new s.I9Y,m=new s.I9Y,g=new s.I9Y,b=new s.I9Y,w=new s.I9Y,v=new s.I9Y,y=new s.I9Y,f=new s.Pq0,x=new s.I9Y;let M=!1;const k=[],S={};let C=!1;function P(e){const t=Math.abs(.01*e);return Math.pow(.95,i.zoomSpeed*t)}function L(e){c.theta-=e}function E(e){c.phi-=e}const R=function(){const e=new s.Pq0;return function(t,i){e.setFromMatrixColumn(i,0),e.multiplyScalar(-t),l.add(e)}}(),A=function(){const e=new s.Pq0;return function(t,s){!0===i.screenSpacePanning?e.setFromMatrixColumn(s,1):(e.setFromMatrixColumn(s,0),e.crossVectors(i.object.up,e)),e.multiplyScalar(t),l.add(e)}}(),T=function(){const e=new s.Pq0;return function(t,s){const n=i.domElement;if(i.object.isPerspectiveCamera){const o=i.object.position;e.copy(o).sub(i.target);let a=e.length();a*=Math.tan(i.object.fov/2*Math.PI/180),R(2*t*a/n.clientHeight,i.object.matrix),A(2*s*a/n.clientHeight,i.object.matrix)}else i.object.isOrthographicCamera?(R(t*(i.object.right-i.object.left)/i.object.zoom/n.clientWidth,i.object.matrix),A(s*(i.object.top-i.object.bottom)/i.object.zoom/n.clientHeight,i.object.matrix)):i.enablePan=!1}}();function z(e){i.object.isPerspectiveCamera||i.object.isOrthographicCamera?h/=e:i.enableZoom=!1}function j(e){i.object.isPerspectiveCamera||i.object.isOrthographicCamera?h*=e:i.enableZoom=!1}function I(e,t){if(!i.zoomToCursor)return;M=!0;const s=i.domElement.getBoundingClientRect(),n=e-s.left,o=t-s.top,a=s.width,r=s.height;x.x=n/a*2-1,x.y=-o/r*2+1,f.set(x.x,x.y,1).unproject(i.object).sub(i.object.position).normalize()}function B(e){return Math.max(i.minDistance,Math.min(i.maxDistance,e))}function O(e){d.set(e.clientX,e.clientY)}function D(e){m.set(e.clientX,e.clientY)}function U(e){if(1===k.length)d.set(e.pageX,e.pageY);else{const t=ee(e),i=.5*(e.pageX+t.x),s=.5*(e.pageY+t.y);d.set(i,s)}}function Y(e){if(1===k.length)m.set(e.pageX,e.pageY);else{const t=ee(e),i=.5*(e.pageX+t.x),s=.5*(e.pageY+t.y);m.set(i,s)}}function F(e){const t=ee(e),i=e.pageX-t.x,s=e.pageY-t.y,n=Math.sqrt(i*i+s*s);w.set(0,n)}function V(e){if(1==k.length)u.set(e.pageX,e.pageY);else{const t=ee(e),i=.5*(e.pageX+t.x),s=.5*(e.pageY+t.y);u.set(i,s)}p.subVectors(u,d).multiplyScalar(i.rotateSpeed);const t=i.domElement;L(2*Math.PI*p.x/t.clientHeight),E(2*Math.PI*p.y/t.clientHeight),d.copy(u)}function G(e){if(1===k.length)g.set(e.pageX,e.pageY);else{const t=ee(e),i=.5*(e.pageX+t.x),s=.5*(e.pageY+t.y);g.set(i,s)}b.subVectors(g,m).multiplyScalar(i.panSpeed),T(b.x,b.y),m.copy(g)}function q(e){const t=ee(e),s=e.pageX-t.x,n=e.pageY-t.y,o=Math.sqrt(s*s+n*n);v.set(0,o),y.set(0,Math.pow(v.y/w.y,i.zoomSpeed)),z(y.y),w.copy(v);I(.5*(e.pageX+t.x),.5*(e.pageY+t.y))}function N(e){!1!==i.enabled&&(0===k.length&&(i.domElement.setPointerCapture(e.pointerId),i.domElement.addEventListener("pointermove",_),i.domElement.addEventListener("pointerup",W)),function(e){for(let t=0;t<k.length;t++)if(k[t]==e.pointerId)return!0;return!1}(e)||(function(e){k.push(e.pointerId)}(e),"touch"===e.pointerType?$(e):function(e){let t;switch(e.button){case 0:t=i.mouseButtons.LEFT;break;case 1:t=i.mouseButtons.MIDDLE;break;case 2:t=i.mouseButtons.RIGHT;break;default:t=-1}switch(t){case s.kBv.DOLLY:if(!1===i.enableZoom)return;!function(e){I(e.clientX,e.clientX),w.set(e.clientX,e.clientY)}(e),o=n.DOLLY;break;case s.kBv.ROTATE:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===i.enablePan)return;D(e),o=n.PAN}else{if(!1===i.enableRotate)return;O(e),o=n.ROTATE}break;case s.kBv.PAN:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===i.enableRotate)return;O(e),o=n.ROTATE}else{if(!1===i.enablePan)return;D(e),o=n.PAN}break;default:o=n.NONE}o!==n.NONE&&i.dispatchEvent(Te)}(e)))}function _(e){!1!==i.enabled&&("touch"===e.pointerType?function(e){switch(J(e),o){case n.TOUCH_ROTATE:if(!1===i.enableRotate)return;V(e),i.update();break;case n.TOUCH_PAN:if(!1===i.enablePan)return;G(e),i.update();break;case n.TOUCH_DOLLY_PAN:if(!1===i.enableZoom&&!1===i.enablePan)return;!function(e){i.enableZoom&&q(e),i.enablePan&&G(e)}(e),i.update();break;case n.TOUCH_DOLLY_ROTATE:if(!1===i.enableZoom&&!1===i.enableRotate)return;!function(e){i.enableZoom&&q(e),i.enableRotate&&V(e)}(e),i.update();break;default:o=n.NONE}}(e):function(e){switch(o){case n.ROTATE:if(!1===i.enableRotate)return;!function(e){u.set(e.clientX,e.clientY),p.subVectors(u,d).multiplyScalar(i.rotateSpeed);const t=i.domElement;L(2*Math.PI*p.x/t.clientHeight),E(2*Math.PI*p.y/t.clientHeight),d.copy(u),i.update()}(e);break;case n.DOLLY:if(!1===i.enableZoom)return;!function(e){v.set(e.clientX,e.clientY),y.subVectors(v,w),y.y>0?z(P(y.y)):y.y<0&&j(P(y.y)),w.copy(v),i.update()}(e);break;case n.PAN:if(!1===i.enablePan)return;!function(e){g.set(e.clientX,e.clientY),b.subVectors(g,m).multiplyScalar(i.panSpeed),T(b.x,b.y),m.copy(g),i.update()}(e)}}(e))}function W(e){switch(function(e){delete S[e.pointerId];for(let t=0;t<k.length;t++)if(k[t]==e.pointerId)return void k.splice(t,1)}(e),k.length){case 0:i.domElement.releasePointerCapture(e.pointerId),i.domElement.removeEventListener("pointermove",_),i.domElement.removeEventListener("pointerup",W),i.dispatchEvent(ze),o=n.NONE;break;case 1:const t=k[0],s=S[t];$({pointerId:t,pageX:s.x,pageY:s.y})}}function K(e){!1!==i.enabled&&!1!==i.enableZoom&&o===n.NONE&&(e.preventDefault(),i.dispatchEvent(Te),function(e){I(e.clientX,e.clientY),e.deltaY<0?j(P(e.deltaY)):e.deltaY>0&&z(P(e.deltaY)),i.update()}(function(e){const t=e.deltaMode,i={clientX:e.clientX,clientY:e.clientY,deltaY:e.deltaY};switch(t){case 1:i.deltaY*=16;break;case 2:i.deltaY*=100}e.ctrlKey&&!C&&(i.deltaY*=10);return i}(e)),i.dispatchEvent(ze))}function Z(e){if("Control"===e.key){C=!0;i.domElement.getRootNode().addEventListener("keyup",H,{passive:!0,capture:!0})}}function H(e){if("Control"===e.key){C=!1;i.domElement.getRootNode().removeEventListener("keyup",H,{passive:!0,capture:!0})}}function X(e){!1!==i.enabled&&!1!==i.enablePan&&function(e){let t=!1;switch(e.code){case i.keys.UP:e.ctrlKey||e.metaKey||e.shiftKey?E(2*Math.PI*i.rotateSpeed/i.domElement.clientHeight):T(0,i.keyPanSpeed),t=!0;break;case i.keys.BOTTOM:e.ctrlKey||e.metaKey||e.shiftKey?E(-2*Math.PI*i.rotateSpeed/i.domElement.clientHeight):T(0,-i.keyPanSpeed),t=!0;break;case i.keys.LEFT:e.ctrlKey||e.metaKey||e.shiftKey?L(2*Math.PI*i.rotateSpeed/i.domElement.clientHeight):T(i.keyPanSpeed,0),t=!0;break;case i.keys.RIGHT:e.ctrlKey||e.metaKey||e.shiftKey?L(-2*Math.PI*i.rotateSpeed/i.domElement.clientHeight):T(-i.keyPanSpeed,0),t=!0}t&&(e.preventDefault(),i.update())}(e)}function $(e){switch(J(e),k.length){case 1:switch(i.touches.ONE){case s.wtR.ROTATE:if(!1===i.enableRotate)return;U(e),o=n.TOUCH_ROTATE;break;case s.wtR.PAN:if(!1===i.enablePan)return;Y(e),o=n.TOUCH_PAN;break;default:o=n.NONE}break;case 2:switch(i.touches.TWO){case s.wtR.DOLLY_PAN:if(!1===i.enableZoom&&!1===i.enablePan)return;!function(e){i.enableZoom&&F(e),i.enablePan&&Y(e)}(e),o=n.TOUCH_DOLLY_PAN;break;case s.wtR.DOLLY_ROTATE:if(!1===i.enableZoom&&!1===i.enableRotate)return;!function(e){i.enableZoom&&F(e),i.enableRotate&&U(e)}(e),o=n.TOUCH_DOLLY_ROTATE;break;default:o=n.NONE}break;default:o=n.NONE}o!==n.NONE&&i.dispatchEvent(Te)}function Q(e){!1!==i.enabled&&e.preventDefault()}function J(e){let t=S[e.pointerId];void 0===t&&(t=new s.I9Y,S[e.pointerId]=t),t.set(e.pageX,e.pageY)}function ee(e){const t=e.pointerId===k[0]?k[1]:k[0];return S[t]}i.domElement.addEventListener("contextmenu",Q),i.domElement.addEventListener("pointerdown",N),i.domElement.addEventListener("pointercancel",W),i.domElement.addEventListener("wheel",K,{passive:!1});i.domElement.getRootNode().addEventListener("keydown",Z,{passive:!0,capture:!0}),this.update()}}const De=Oe;class Ue{constructor(){this.experience=new Fe,this.bannerLinks=document.querySelectorAll(".banner-link"),this.backButton=document.getElementById("back-button"),this.whiteboardButons=document.getElementById("whiteboard-buttons"),this.banner=document.querySelector(".banner"),this.rubikMessage=document.querySelector(".rubik-message"),this.webglElement=this.experience.webglElement,this.camera=this.experience.camera,this.config=this.experience.config,this.scene=this.experience.scene,this.mouse=this.experience.mouse,this.currentStage=null,this.outlinePass=this.experience.renderer.postProcess.outlinePass,this.raycaster=this.experience.raycaster,this.selectedObjects=[],this.startClick=new s.I9Y(null,null),this.isCameraMoving=!1,this.setNavigation(),this.activateControls()}setNavigation(){this.orbitControls=new De(this.camera.instance,this.webglElement),this.orbitControls.enabled=oe.enabled,this.orbitControls.screenSpacePanning=oe.screenSpacePanning,this.orbitControls.enableKeys=oe.enableKeys,this.orbitControls.zoomSpeed=oe.zoomSpeed,this.orbitControls.enableDamping=oe.enableDamping,this.orbitControls.dampingFactor=oe.dampingFactor,this.orbitControls.rotateSpeed=oe.rotateSpeed,this.orbitControls.maxAzimuthAngle=oe.maxAzimuthAngle,this.orbitControls.minAzimuthAngle=oe.minAzimuthAngle,this.orbitControls.minPolarAngle=oe.minPolarAngle,this.orbitControls.maxPolarAngle=oe.maxPolarAngle,this.orbitControls.minDistance=oe.minDistance,this.orbitControls.maxDistance=oe.maxDistance,this.orbitControls.target.y=oe.target.y,this.orbitControls.update(),this.orbitControls.addEventListener("change",this.handleBannerVisibility),this.bannerLinks.forEach((e=>{e.addEventListener("click",(()=>{"rubikGroup"==this.currentStage&&this.experience.world.rubiksCube.isMoving||this.isCameraMoving||this.currentStage===e.id||this.flyToPosition(e.id)}))})),this.backButton.addEventListener("click",(()=>{if(!this.isCameraMoving)if("rubikGroup"!=this.currentStage||this.experience.world.rubiksCube.isMoving){if(null!==this.currentStage&&"rubikGroup"!==this.currentStage){this.whiteboardButons.classList.contains("show-button-row")&&this.whiteboardButons.classList.remove("show-button-row"),this.orbitControls.enableDamping=!1,this.orbitControls.enabled=!1;this.experience.world.audioManager.playSingleAudio("whoosh",.2),this.moveCamera(I.x,I.y,I.z,1),this.rotateCamera(B.x,B.y,B.z,B.w,1.15,null),this.changeTarget(O.x,O.y,O.z,1),this.backButton.classList.remove("show-back-button")}}else this.bringSceneBack(),this.experience.world.rubiksCube.resetOriginalConfig(),this.activateScene()}))}rubikWon=()=>{this.bringSceneBack(),this.activateScene()};bringSceneBack=()=>{this.experience.world.audioManager.playSingleAudio("whoosh",.2),this.rubikMessage.classList.contains("show-rubik-message")&&this.rubikMessage.classList.remove("show-rubik-message"),this.orbitControls.enableDamping=!1,this.orbitControls.enabled=!1,this.expandScene(this.experience.scene,this.sceneResult),this.expandScene(this.experience.cssArcadeMachineScene,this.cssArcadeMachineSceneResult),this.expandScene(this.experience.cssLeftMonitorScene,this.cssLeftMonitorSceneResult),this.expandScene(this.experience.cssRightMonitorScene,this.cssRightMonitorSceneResult),this.changeTarget(O.x,O.y,O.z,1),this.backButton.classList.remove("show-back-button")};activateControls(){window.addEventListener("keydown",this.onKeyDown,!1),window.addEventListener("pointermove",this.onMouseMove,!1),window.addEventListener("pointerdown",this.onMouseDown,!1),window.addEventListener("pointerup",this.onMouseUp,!1)}deactivateControls(){window.removeEventListener("keydown",this.onKeyDown,!1),window.removeEventListener("pointerdown",this.onMouseDown,!1),window.removeEventListener("pointerup",this.onMouseUp,!1)}checkIntersection(){this.raycaster.setFromCamera(this.mouse,this.camera.instance);const e=this.scene.children.filter((e=>ne.includes(e.name))),t=this.raycaster.intersectObjects(e,!0);if(t&&t.length){const e=t[0].object.parent.isRubik?t[0].object.parent.parent:t[0].object.parent,i=!this.selectedObjects.length||this.selectedObjects[0].name!=e.name;this.selectedObjects=i?[e]:this.selectedObjects,this.objectRaycasted=this.selectedObjects[0].name,this.webglElement.style.cursor="pointer"}else this.objectRaycasted=null,this.startClick.set(null,null),this.selectedObjects=[],this.webglElement.style.cursor="auto";this.outlinePass.selectedObjects=this.selectedObjects}getCurrentZoom(){const e=this.camera.instance.position,t=this.orbitControls.target;return e.distanceTo(t)}onMouseMove=e=>{this.mouse.x=e.clientX/window.innerWidth*2-1,this.mouse.y=-e.clientY/window.innerHeight*2+1,null==this.currentStage&&!this.isCameraMoving&&this.experience.world?.rubiksCube?.isPlaced&&!this.experience.world?.confetti?.hasExploded&&this.experience.world.resources.loader.resourcesLoaded?this.checkIntersection():(this.objectRaycasted=null,this.startClick.set(null,null),this.selectedObjects=[],this.webglElement.style.cursor="auto"),this.handleBannerVisibility()};onMouseDown=()=>{this.startClick.x=this.mouse.x,this.startClick.y=this.mouse.y};clickOnActivity(){this.deactivateControls(),this.webglElement.style.cursor="auto",this.isCameraMoving=!0,this.outlinePass.selectedObjects=[]}flyToPosition=e=>{const t=this.experience.world.audioManager;switch("rubikGroup"!==e&&"rubikGroup"==this.currentStage&&(this.rubikMessage.classList.remove("show-rubik-message"),this.bringSceneBack(),this.experience.world.rubiksCube.resetOriginalConfig(),this.activateScene()),"whiteboard"!=e&&this.whiteboardButons.classList.contains("show-button-row")&&this.whiteboardButons.classList.remove("show-button-row"),this.currentStage&&this.deactivateActivityControls(),e){case"arcadeMachine":t.playSingleAudio("whoosh",.2),this.backButton.classList.add("show-back-button"),this.orbitControls.enableDamping=!1,this.orbitControls.enabled=!1,this.moveCamera(T.x,T.y,T.z,1),this.rotateCamera(z.x,z.y,z.z,z.w,1.15,e),this.changeTarget(j.x,j.y,j.z,1),this.clickOnActivity();break;case"leftMonitor":t.playSingleAudio("whoosh",.2),this.backButton.classList.add("show-back-button"),this.orbitControls.enableDamping=!1,this.orbitControls.enabled=!1,this.moveCamera(H.x,H.y,H.z,1),this.rotateCamera(X.x,X.y,X.z,X.w,1.15,e),this.changeTarget($.x,$.y,$.z,1),this.clickOnActivity();break;case"rightMonitor":t.playSingleAudio("whoosh",.2),this.backButton.classList.add("show-back-button"),this.orbitControls.enableDamping=!1,this.orbitControls.enabled=!1,this.moveCamera(te.x,te.y,te.z,1),this.rotateCamera(ie.x,ie.y,ie.z,ie.w,1.15,e),this.changeTarget(se.x,se.y,se.z,1),this.clickOnActivity();break;case"whiteboard":t.playSingleAudio("whoosh",.2),this.backButton.classList.add("show-back-button"),this.whiteboardButons.classList.add("show-button-row"),this.orbitControls.enableDamping=!1,this.orbitControls.enabled=!1,this.moveCamera(ae.x,ae.y,ae.z,1),this.rotateCamera(re.x,re.y,re.z,re.w,1.15,e),this.changeTarget(ce.x,ce.y,ce.z,1),this.clickOnActivity();break;case"rubikGroup":t.playSingleAudio("whoosh",.2),this.rubikMessage.classList.add("show-rubik-message"),this.backButton.classList.add("show-back-button"),this.orbitControls.enableDamping=!1,this.orbitControls.enabled=!1,this.experience.world.rubiksCube.reubicateCube(),this.sceneResult=this.shrinkScene(this.experience.scene),this.cssArcadeMachineSceneResult=this.shrinkScene(this.experience.cssArcadeMachineScene),this.cssLeftMonitorSceneResult=this.shrinkScene(this.experience.cssLeftMonitorScene),this.cssRightMonitorSceneResult=this.shrinkScene(this.experience.cssRightMonitorScene),this.moveCamera(I.x,I.y,I.z,.3),this.rotateCamera(B.x,B.y,B.z,B.w,1.15,e),this.changeTarget(he.x,he.y,he.z,1),this.clickOnActivity();break;case"linkedin":window.open("https://www.linkedin.com/in/joan-ramos-refusta/");break;case"github":window.open("https://github.com/jrefusta");break;case"itchio":window.open("https://jrefusta.itch.io/")}};onMouseUp=()=>{this.startClick.x==this.mouse.x&&this.startClick.y==this.mouse.y&&(this.isCameraMoving||null===this.objectRaycasted||this.currentStage===this.objectRaycasted||this.flyToPosition(this.objectRaycasted)),this.startClick.set(null,null)};moveCamera(e,t,i,s){u.Ay.to(this.camera.instance.position,{x:e,y:t,z:i,duration:s,ease:"sine.out"})}rotateCamera(e,t,i,s,n,o){u.Ay.to(this.camera.instance.quaternion,{x:e,y:t,z:i,w:s,duration:n,ease:"sine.out",onComplete:()=>{this.currentStage=o,null===this.currentStage&&(this.orbitControls.enableDamping=!0,this.orbitControls.enabled=!0),this.isCameraMoving=!1,this.updateStage(),this.orbitControls.addEventListener("change",this.handleChangeEvent)}})}changeTarget(e,t,i,s){u.Ay.to(this.orbitControls.target,{x:e,y:t,z:i,duration:s,ease:"sine.out"})}shrinkScene(e){const t=[],i=[];return e.children.forEach((e=>{"PerspectiveCamera"!=e.type&&"rubikGroup"!=e.name&&"DirectionalLight"!=e.type&&"AmbientLight"!=e.type&&"rubikPivot"!=e.name?(t.push(e.position.clone()),u.Ay.to(e.position,{x:0,y:0,z:0,duration:1,ease:"sine.out"}),i.push(e.scale.clone()),u.Ay.to(e.scale,{x:1e-4,y:1e-4,z:1e-4,duration:1,ease:"sine.out"})):(t.push(null),i.push(null))})),{originalPos:t,originalScale:i}}expandScene(e,t){e.children.forEach(((e,i)=>{"PerspectiveCamera"!=e.type&&"rubikGroup"!=e.name&&"DirectionalLight"!=e.type&&"AmbientLight"!=e.type&&"rubikPivot"!=e.name&&(null!==t.originalPos[i]&&u.Ay.to(e.position,{x:t.originalPos[i].x,y:t.originalPos[i].y,z:t.originalPos[i].z,duration:1,ease:"sine.out",onComplete:()=>{this.orbitControls.enableDamping=!0,this.orbitControls.enabled=!0}}),null!==t.originalScale[i]&&u.Ay.to(e.scale,{x:t.originalScale[i].x,y:t.originalScale[i].y,z:t.originalScale[i].z,duration:1,ease:"sine.out"}))}))}handleChangeEvent=()=>{null!=this.currentStage&&this.orbitControls.enabled&&(!this.isCameraMoving&&this.whiteboardButons.classList.contains("show-button-row")&&this.whiteboardButons.classList.remove("show-button-row"),!this.isCameraMoving&&this.backButton.classList.contains("show-back-button")&&this.backButton.classList.remove("show-back-button"),this.activateScene(),this.orbitControls.removeEventListener("change",this.handleChangeEvent))};activateScene(){this.deactivateActivityControls(),this.currentStage=null,this.activateControls()}deactivateActivityControls=()=>{switch(this.currentStage){case"arcadeMachine":this.experience.world.arcadeScreen.deactivateControls();break;case"whiteboard":this.experience.world.whiteboard.deactivateControls();break;case"leftMonitor":this.experience.world.leftMonitorScreen.deactivateControls();break;case"rightMonitor":this.experience.world.rightMonitorScreen.deactivateControls();break;case"rubikGroup":this.experience.world.rubiksCube.deactivateControls()}};handleBannerVisibility=()=>{if(!this.experience.world.resources.loader.resourcesLoaded)return;const e=this.getCurrentZoom();null===this.currentStage?e<25&&this.mouse.y<.9?this.banner.style.top="-60px":this.banner.style.top="0px":this.mouse.y<.9?this.banner.style.top="-60px":this.banner.style.top="0px"};updateStage(){switch(this.currentStage){case"arcadeMachine":this.experience.world.arcadeScreen.activateControls();break;case"whiteboard":this.experience.world.whiteboard.activateControls();break;case"leftMonitor":this.experience.world.leftMonitorScreen.activateControls();break;case"rightMonitor":this.experience.world.rightMonitorScreen.activateControls();break;case"rubikGroup":this.experience.world.rubiksCube.activateControls()}}update(){this.orbitControls.update()}}const Ye=[{name:"base",data:{},items:[{name:"topChairModel",source:"/assets/models/topChair.glb",type:"model"},{name:"rubiksCube",source:"/assets/models/Rubik.glb"},{name:"skyTexture",source:"/assets/textures/skyTexture.ktx2",type:"texture"},{name:"perlin",source:"/assets/textures/perlin.png",type:"texture"},{name:"baked1",source:"/assets/textures/baked1.ktx2",type:"texture"},{name:"baked2",source:"/assets/textures/baked2.ktx2",type:"texture"},{name:"baked3",source:"/assets/textures/baked3.ktx2",type:"texture"},{name:"texture_paint",source:"/assets/textures/texture_paint.png",type:"texture"},{name:"_roomModel",source:"/assets/models/room.glb"},{name:"_roomModel2",source:"/assets/models/room2.glb"},{name:"_roomModel3",source:"/assets/models/room3.glb"},{name:"whiteboard",source:"/assets/models/whiteboard.glb"},{name:"leftMonitor",source:"/assets/models/leftMonitor.glb"},{name:"rightMonitor",source:"/assets/models/rightMonitor.glb"},{name:"arcadeMachine",source:"/assets/models/arcadeMachine.glb"},{name:"linkedin",source:"/assets/models/linkedin.glb"},{name:"github",source:"/assets/models/github.glb"},{name:"itchio",source:"/assets/models/itchio.glb"},{name:"cubeTexture",source:["/assets/environmentMaps/nx.jpg","/assets/environmentMaps/ny.jpg","/assets/environmentMaps/nz.jpg","/assets/environmentMaps/px.jpg","/assets/environmentMaps/py.jpg","/assets/environmentMaps/pz.jpg"],type:"cubeTexture"},{name:"markerOpen",source:"assets/sounds/marker-open.mp3"},{name:"eraser",source:"assets/sounds/eraser.mp3"},{name:"confetti",source:"assets/sounds/confetti.mp3"},{name:"partyblower",source:"assets/sounds/partyblower.mp3"},{name:"footstep01",source:"assets/sounds/footstep01.ogg"},{name:"footstep02",source:"assets/sounds/footstep02.ogg"},{name:"footstep03",source:"assets/sounds/footstep03.ogg"},{name:"mouseclick",source:"assets/sounds/mouseclick.ogg"},{name:"mouserelease",source:"assets/sounds/mouserelease.ogg"},{name:"rubik_1",source:"assets/sounds/rubik_1.mp3"},{name:"rubik_2",source:"assets/sounds/rubik_2.mp3"},{name:"rubik_3",source:"assets/sounds/rubik_3.mp3"},{name:"start",source:"assets/sounds/start.mp3"},{name:"vase_break",source:"assets/sounds/vase_break.mp3"},{name:"door",source:"assets/sounds/door.mp3"},{name:"trophy",source:"assets/sounds/trophy.mp3"},{name:"trophy_platinum",source:"assets/sounds/trophy_platinum.mp3"},{name:"floral",source:"assets/sounds/floral.mp3"},{name:"hit",source:"assets/sounds/hit.ogg"},{name:"tetris",source:"assets/sounds/tetris.ogg"},{name:"die",source:"assets/sounds/die.ogg"},{name:"whoosh",source:"assets/sounds/whoosh.mp3"},{name:"select1",source:"assets/sounds/select1.ogg"},{name:"select2",source:"assets/sounds/select2.ogg"},{name:"screnshot",source:"assets/social/screenshot.png"}]}];class Fe{static instance;constructor(e={}){if(Fe.instance)return Fe.instance;Fe.instance=this,this.webglElement=e.webglElement,this.cssArcadeMachine=e.cssArcadeMachine,this.cssLeftMonitor=e.cssLeftMonitor,this.cssRightMonitor=e.cssRightMonitor,this.webglElement&&(this.time=new o,this.clock=new s.zD7,this.raycaster=new s.tBo,this.sizes=new a,this.mouse=new s.I9Y,this.setConfig(),this.setScene(),this.setCamera(),this.setRenderer(),this.setResources(),this.setWorld(),this.setNavigation(),this.sizes.on("resize",(()=>{this.resize()})),this.update())}setConfig(){this.config={},this.config.pixelRatio=Math.min(Math.max(window.devicePixelRatio,1),2);const e=this.webglElement.getBoundingClientRect();this.config.width=e.width,this.config.height=e.height||window.innerHeight,this.config.smallestSide=Math.min(this.config.width,this.config.height),this.config.largestSide=Math.max(this.config.width,this.config.height)}setScene(){this.scene=new s.Z58,this.cssArcadeMachineScene=new s.Z58,this.cssLeftMonitorScene=new s.Z58,this.cssRightMonitorScene=new s.Z58}setCamera(){this.camera=new pe}setRenderer(){this.renderer=new k({rendererInstance:this.rendererInstance})}setResources(){this.resources=new m(Ye)}setWorld(){this.world=new Le}setNavigation(){this.navigation=new Ue}update(){this.navigation&&this.navigation.update(),this.camera.update(),this.renderer&&this.renderer.update(),this.world&&this.world.update(),window.requestAnimationFrame((()=>{this.update()}))}resize(){const e=this.webglElement.getBoundingClientRect();this.config.width=e.width,this.config.height=e.height,this.config.smallestSide=Math.min(this.config.width,this.config.height),this.config.largestSide=Math.max(this.config.width,this.config.height),this.config.pixelRatio=Math.min(Math.max(window.devicePixelRatio,1),2),this.camera&&this.camera.resize(),this.renderer&&this.renderer.resize(),this.world&&this.world.resize()}}const Ve=/Mobi|Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)||navigator.userAgentData?.mobile;if(window.innerWidth>768&&!Ve)window.experience=new Fe({webglElement:document.querySelector("#webgl"),cssArcadeMachine:document.querySelector("#cssArcadeMachine"),cssLeftMonitor:document.querySelector("#cssLeftMonitor"),cssRightMonitor:document.querySelector("#cssRightMonitor")});else{document.querySelector(".mobile-text").style.display="block"}}},e=>{e.O(0,[86,847],(()=>{return t=267,e(e.s=t);var t}));e.O()}]);